<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025ÎÖÑÎèÑ ÏÉÅÎ∞òÍ∏∞ ÏÑúÏãúÍ≥µ Ïñ¥ÏõåÎìú Ïö∞ÏàòÍ≥ºÏ†ú ÌèâÍ∞Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: 'üèÜ';
            font-size: 3em;
            position: absolute;
            top: 15px;
            left: 30px;
            opacity: 0.3;
        }

        .header::after {
            content: '‚≠ê';
            font-size: 2em;
            position: absolute;
            top: 20px;
            right: 30px;
            opacity: 0.3;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .nav-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: #4CAF50;
            color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .nav-tab:hover:not(.active) {
            background: #e9ecef;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .evaluation-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            height: 100%;
            transition: width 0.3s ease;
        }

        .step-info {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #e8f5e8;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
        }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .criteria-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .criteria-item:hover {
            border-color: #4CAF50;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .criteria-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .criteria-title {
            font-weight: 600;
            color: #333;
        }

        .criteria-max {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .score-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1.1em;
            text-align: center;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .evaluation-summary {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e0e0e0;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-score {
            font-weight: bold;
            color: #4CAF50;
        }

        .evaluator-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .results-table th,
        .results-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .results-table th {
            background: #4CAF50;
            color: white;
            font-weight: 600;
        }

        .results-table tr:hover {
            background: #f8f9fa;
        }

        .rank-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            color: white;
        }

        .rank-1 { background: #FFD700; color: #333; }
        .rank-2 { background: #C0C0C0; color: #333; }
        .rank-3 { background: #CD7F32; }
        .rank-other { background: #6c757d; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 600;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.1em;
            color: #666;
        }

        .evaluation-info-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #f0f0f0;
            transition: all 0.3s ease;
        }

        .evaluation-info-card:hover {
            border-color: #4CAF50;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .evaluation-info-card h3 {
            color: #4CAF50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .evaluation-info-card ul {
            list-style: none;
            padding: 0;
        }

        .evaluation-info-card li {
            padding: 5px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .evaluation-info-card li:last-child {
            border-bottom: none;
        }

        @media (max-width: 768px) {
            .criteria-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .evaluation-info-card {
                margin-bottom: 15px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .header p {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>2025ÎÖÑÎèÑ ÏÉÅÎ∞òÍ∏∞ ÏÑúÏãúÍ≥µ Ïñ¥ÏõåÎìú</h1>
            <p>Ïö∞ÏàòÍ≥ºÏ†ú ÌèâÍ∞Ä ÏãúÏä§ÌÖú</p>
        </div>

        <div class="nav-tabs" id="navTabs">
            <button class="nav-tab active" onclick="showTab('welcome')" id="welcomeTab">ÌèâÍ∞Ä ÏïàÎÇ¥</button>
            <button class="nav-tab" onclick="showTab('evaluation')" id="evaluationTab">ÌèâÍ∞Ä ÏûÖÎ†•</button>
            <button class="nav-tab" onclick="showTab('results')" id="resultsTab" style="display: none;">Ïã§ÏãúÍ∞Ñ Í≤∞Í≥º</button>
            <button class="nav-tab" onclick="showTab('monitor')" id="monitorTab" style="display: none;">ÌòÑÌô© Î™®ÎãàÌÑ∞ÎßÅ</button>
            <button class="nav-tab" onclick="showTab('management')" id="managementTab" style="display: none;">ÌèâÍ∞Ä Í¥ÄÎ¶¨</button>
        </div>

        <!-- ÌèâÍ∞Ä ÏïàÎÇ¥ ÌÉ≠ -->
        <div id="welcome" class="tab-content active">
            <div style="text-align: center; padding: 40px 20px;">
                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px; padding: 40px; margin-bottom: 30px;">
                    <h2 style="color: #4CAF50; margin-bottom: 20px; font-size: 2em;">üèÜ 2025ÎÖÑÎèÑ ÏÉÅÎ∞òÍ∏∞ ÏÑúÏãúÍ≥µ Ïñ¥ÏõåÎìú ÌèâÍ∞ÄÏóê Ï∞∏Ïó¨Ìï¥Ï£ºÏÖîÏÑú Í∞êÏÇ¨Ìï©ÎãàÎã§!</h2>
                    <p style="font-size: 1.2em; color: #666; line-height: 1.6;">
                        ÏïÑÎûò ÎÇ¥Ïö©ÏùÑ ÌôïÏù∏ ÌõÑ Ï¥ù 8Í∞ú Ïö∞ÏàòÍ≥ºÏ†ú Î∞úÌëúÌåÄÏùò ÏÑ±Í≥ºÎ•º Í≥µÏ†ïÌïòÍ≤å ÌèâÍ∞ÄÌï¥Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.
                    </p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="evaluation-info-card">
                        <h3>üìã ÌèâÍ∞Ä Ìï≠Î™©</h3>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li><strong>Ï∞ΩÏùòÏÑ±</strong>: 18~30Ï†ê</li>
                            <li><strong>ÎÇúÏù¥ÎèÑ</strong>: 18~30Ï†ê</li>
                            <li><strong>Ìö®Í≥ºÏÑ±</strong>: 12~20Ï†ê</li>
                            <li><strong>Ï†ÑÌååÏÑ±</strong>: 6~10Ï†ê</li>
                            <li><strong>Í∏∞Ïó¨ÎèÑ</strong>: 6~10Ï†ê</li>
                        </ul>
                        <p style="color: #4CAF50; font-weight: bold;">Ï¥ù 60~100Ï†ê</p>
                    </div>

                    <div class="evaluation-info-card">
                        <h3>üéØ Ïö∞ÏàòÍ≥ºÏ†ú Î∞úÌëú Î∂ÄÏÑú</h3>
                        <ul style="text-align: left; margin: 15px 0; font-size: 0.95em;">
                            <li>ITÏ†ÑÎûµÏã§</li>
                            <li>Ïû•Ïï†Ïù∏ÏΩúÌÉùÏãúÏö¥ÏòÅÏ≤ò</li>
                            <li>ÏÑúÏö∏Ïñ¥Î¶∞Ïù¥ÎåÄÍ≥µÏõê</li>
                            <li>Ï≤≠Í≥ÑÏ≤úÍ¥ÄÎ¶¨Ï≤ò</li>
                            <li>ÏûêÏÇ∞Í¥ÄÎ¶¨ÌòÅÏã†Ï≤ò</li>
                            <li>Í≥µÏÇ¨Í∞êÎèÖ1Ï≤ò</li>
                            <li>Ï£ºÏ∞®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò</li>
                            <li>Í≥µÍ≥µÏûêÏ†ÑÍ±∞Ïö¥ÏòÅÏ≤ò</li>
                        </ul>
                    </div>

                    <div class="evaluation-info-card">
                        <h3>‚ö†Ô∏è ÌèâÍ∞Ä Ï†úÌïúÏÇ¨Ìï≠</h3>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li><strong>ÏßÅÏõê</strong>: Î≥∏Ïù∏ ÏÜåÏÜçÎ∂ÄÏÑú ÌèâÍ∞Ä Î∂àÍ∞Ä</li>
                            <li><strong>Î≥∏Î∂ÄÏû•</strong>: Îã¥Îãπ Î≥∏Î∂Ä Î∞úÌëúÌåÄ ÌèâÍ∞Ä Î∂àÍ∞Ä</li>
                            <li><strong>Ïù¥ÏÇ¨Ïû•</strong>: Î™®Îì† ÌåÄ ÌèâÍ∞Ä Í∞ÄÎä•</li>
                        </ul>
                        <p style="color: #dc3545; font-weight: bold; font-size: 0.9em;">
                            ‚Äª Í≥µÏ†ïÌïú ÌèâÍ∞ÄÎ•º ÏúÑÌï¥ ÏûêÎèôÏúºÎ°ú Ï†úÌïúÎê©ÎãàÎã§
                        </p>
                    </div>
                </div>

                <div style="background: white; border: 2px solid #4CAF50; border-radius: 15px; padding: 30px; margin: 20px 0; text-align: center;">
                    <h4 style="color: #4CAF50; margin-bottom: 20px; font-size: 1.3em;">üì± Î™®Î∞îÏùº/ÌÉúÎ∏îÎ¶ø Ï†ëÏÜç</h4>
                    
                    <div style="display: flex; justify-content: center; align-items: center; gap: 30px; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin-bottom: 15px;">
                                <img src="" 
                                     alt="QR Code" 
                                     style="width: 200px; height: 200px; border-radius: 8px;"
                                     id="mainQRCode">
                            </div>
                            <p style="font-weight: bold; color: #4CAF50; margin-bottom: 5px;">QRÏΩîÎìúÎ°ú Î∞îÎ°ú Ï†ëÏÜç</p>
                            <p style="font-size: 0.9em; color: #666;">Ïä§ÎßàÌä∏Ìè∞ Ïπ¥Î©îÎùºÎ°ú Ïä§Ï∫îÌïòÏÑ∏Ïöî</p>
                        </div>
                        
                        <div style="text-align: left; max-width: 350px;">
                            <h5 style="color: #4CAF50; margin-bottom: 15px;">üîó ÏßÅÏ†ë Ï†ëÏÜç Ï£ºÏÜå</h5>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #dee2e6;">
                                <div style="font-family: 'Courier New', monospace; font-size: 0.9em; word-break: break-all;" id="currentURL">
                                    
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                                <button class="btn btn-secondary" onclick="copyMainLink()" style="font-size: 0.9em;">üìã Î≥µÏÇ¨</button>
                                <button class="btn btn-secondary" onclick="shareMainLink()" style="font-size: 0.9em;">üì§ Í≥µÏú†</button>
                            </div>

                            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; border: 1px solid #ffc107; margin-top: 15px;">
                                <p style="font-size: 0.85em; color: #856404; margin: 0;"><strong>üìã Í¥ÄÎ¶¨ÏûêÏö© Ï†ëÏÜç:</strong></p>
                                <p style="font-size: 0.8em; color: #856404; margin: 5px 0 0 0;">URL Îí§Ïóê <code>?admin=true</code> Ï∂îÍ∞Ä</p>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" style="font-size: 1.3em; padding: 15px 40px; margin-top: 20px;" onclick="showTab('evaluation')">
                    ÌèâÍ∞Ä ÏãúÏûëÌïòÍ∏∞ ‚Üí
                </button>
            </div>
        </div>

        <!-- ÌèâÍ∞Ä ÏûÖÎ†• ÌÉ≠ -->
        <div id="evaluation" class="tab-content">
            <!-- ÌèâÍ∞ÄÏûê Ï†ïÎ≥¥ ÏûÖÎ†• Îã®Í≥Ñ -->
            <div id="evaluatorInfoStep">
                <div class="evaluation-form">
                    <h2 style="margin-bottom: 20px; color: #333;">ÌèâÍ∞ÄÏûê Ï†ïÎ≥¥ ÏûÖÎ†•</h2>
                    
                    <div class="form-group">
                        <label for="evaluatorType">ÌèâÍ∞ÄÏûê Íµ¨Î∂Ñ</label>
                        <select id="evaluatorType" onchange="updateEvaluatorOptions()">
                            <option value="">ÌèâÍ∞ÄÏûê Íµ¨Î∂Ñ ÏÑ†ÌÉù</option>
                            <option value="chairman">Ïù¥ÏÇ¨Ïû•</option>
                            <option value="executive">Î≥∏Î∂ÄÏû•</option>
                            <option value="employee">ÏßÅÏõê</option>
                        </select>
                    </div>

                    <div class="form-group" id="executiveGroup" style="display: none;">
                        <label for="executivePosition">ÏÜåÏÜçÎ≥∏Î∂Ä</label>
                        <select id="executivePosition">
                            <option value="">ÏÜåÏÜçÎ≥∏Î∂Ä ÏÑ†ÌÉù</option>
                            <option value="Í≤ΩÏòÅÏ†ÑÎûµÎ≥∏Î∂ÄÏû•">Í≤ΩÏòÅÏ†ÑÎûµ</option>
                            <option value="Î≥µÏßÄÍ≤ΩÏ†úÎ≥∏Î∂ÄÏû•">Î≥µÏßÄÍ≤ΩÏ†ú</option>
                            <option value="Î¨∏ÌôîÏ≤¥Ïú°Î≥∏Î∂ÄÏû•">Î¨∏ÌôîÏ≤¥Ïú°</option>
                            <option value="ÎèÑÎ°úÍ¥ÄÎ¶¨Î≥∏Î∂ÄÏû•">ÎèÑÎ°úÍ¥ÄÎ¶¨</option>
                            <option value="ÏãúÏÑ§ÏïàÏ†ÑÎ≥∏Î∂ÄÏû•">ÏãúÏÑ§ÏïàÏ†Ñ</option>
                            <option value="ÍµêÌÜµÏÇ¨ÏóÖÎ≥∏Î∂ÄÏû•">ÍµêÌÜµÏÇ¨ÏóÖ</option>
                        </select>
                    </div>

                    <div class="form-group" id="evaluatorNameGroup">
                        <label for="evaluatorName">ÌèâÍ∞ÄÏûêÎ™Ö</label>
                        <input type="text" id="evaluatorName" placeholder="ÌèâÍ∞ÄÏûê Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                    </div>

                    <div class="form-group" id="departmentGroup" style="display: none;">
                        <label for="evaluatorDept">ÏÜåÏÜç Î∂ÄÏÑú</label>
                        <select id="evaluatorDept">
                            <option value="">Î∂ÄÏÑú ÏÑ†ÌÉù</option>
                            <option value="Í∞êÏÇ¨Ïã§">Í∞êÏÇ¨Ïã§</option>
                            <option value="Í∏∞ÌöçÏ°∞Ï†ïÏã§">Í∏∞ÌöçÏ°∞Ï†ïÏã§</option>
                            <option value="Ïù∏ÏÇ¨ÎÖ∏Î¨¥Ï≤ò">Ïù∏ÏÇ¨ÎÖ∏Î¨¥Ï≤ò</option>
                            <option value="Ï¥ùÎ¨¥Ï≤ò">Ï¥ùÎ¨¥Ï≤ò</option>
                            <option value="ÌôçÎ≥¥Ïã§">ÌôçÎ≥¥Ïã§</option>
                            <option value="Ïù∏Ïû¨Î¨∏ÌôîÏõê">Ïù∏Ïû¨Î¨∏ÌôîÏõê</option>
                            <option value="ITÏ†ÑÎûµÏã§">ITÏ†ÑÎûµÏã§</option>
                            <option value="ÏïàÏ†ÑÏ≤ò">ÏïàÏ†ÑÏ≤ò</option>
                            <option value="ÏÉÅÍ∞ÄÏö¥ÏòÅÏ≤ò">ÏÉÅÍ∞ÄÏö¥ÏòÅÏ≤ò</option>
                            <option value="Ï∂îÎ™®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò">Ï∂îÎ™®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò</option>
                            <option value="Ïû•Ïï†Ïù∏ÏΩúÌÉùÏãúÏö¥ÏòÅÏ≤ò">Ïû•Ïï†Ïù∏ÏΩúÌÉùÏãúÏö¥ÏòÅÏ≤ò</option>
                            <option value="ÏÑúÏö∏ÏõîÎìúÏªµÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò">ÏÑúÏö∏ÏõîÎìúÏªµÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò</option>
                            <option value="ÎèîÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò">ÎèîÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò</option>
                            <option value="ÏÑúÏö∏Ïñ¥Î¶∞Ïù¥ÎåÄÍ≥µÏõê">ÏÑúÏö∏Ïñ¥Î¶∞Ïù¥ÎåÄÍ≥µÏõê</option>
                            <option value="Ï≤≠Í≥ÑÏ≤úÍ¥ÄÎ¶¨Ï≤ò">Ï≤≠Í≥ÑÏ≤úÍ¥ÄÎ¶¨Ï≤ò</option>
                            <option value="ÎÇ®ÏÇ∞Í≥§ÎèåÎùºÏù∏ÏàòÎã®TF">ÎÇ®ÏÇ∞Í≥§ÎèåÎùºÏù∏ÏàòÎã®TF</option>
                            <option value="ÏûêÏÇ∞Í¥ÄÎ¶¨ÌòÅÏã†Ï≤ò">ÏûêÏÇ∞Í¥ÄÎ¶¨ÌòÅÏã†Ï≤ò</option>
                            <option value="ÎèÑÎ°úÍ¥ÄÎ¶¨Ï≤ò">ÎèÑÎ°úÍ¥ÄÎ¶¨Ï≤ò</option>
                            <option value="ÎèÑÎ°úÏãúÏÑ§Ï≤ò">ÎèÑÎ°úÏãúÏÑ§Ï≤ò</option>
                            <option value="ÎèÑÎ°úÍ∏∞Ï†ÑÏ≤ò">ÎèÑÎ°úÍ∏∞Ï†ÑÏ≤ò</option>
                            <option value="ÎèÑÎ°úÌôòÍ≤ΩÏ≤ò">ÎèÑÎ°úÌôòÍ≤ΩÏ≤ò</option>
                            <option value="ÍµêÌÜµÏ†ïÎ≥¥Ï≤ò">ÍµêÌÜµÏ†ïÎ≥¥Ï≤ò</option>
                            <option value="Í≥µÏÇ¨Í∞êÎèÖ1Ï≤ò">Í≥µÏÇ¨Í∞êÎèÖ1Ï≤ò</option>
                            <option value="Í≥µÏÇ¨Í∞êÎèÖ2Ï≤ò">Í≥µÏÇ¨Í∞êÎèÖ2Ï≤ò</option>
                            <option value="Í≥µÏÇ¨Í∞êÎèÖ3Ï≤ò">Í≥µÏÇ¨Í∞êÎèÖ3Ï≤ò</option>
                            <option value="Í≥µÎèôÍµ¨Í¥ÄÎ¶¨Ï≤ò">Í≥µÎèôÍµ¨Í¥ÄÎ¶¨Ï≤ò</option>
                            <option value="ÏÉÅÏàòÎèÑÏßÄÏõêÏ≤ò">ÏÉÅÏàòÎèÑÏßÄÏõêÏ≤ò</option>
                            <option value="Ï£ºÏ∞®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò">Ï£ºÏ∞®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò</option>
                            <option value="ÍµêÌÜµÏãúÏÑ§Ïö¥ÏòÅÏ≤ò">ÍµêÌÜµÏãúÏÑ§Ïö¥ÏòÅÏ≤ò</option>
                            <option value="Í≥µÍ≥µÏûêÏ†ÑÍ±∞Ïö¥ÏòÅÏ≤ò">Í≥µÍ≥µÏûêÏ†ÑÍ±∞Ïö¥ÏòÅÏ≤ò</option>
                        </select>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-primary" onclick="startEvaluation()">ÌèâÍ∞Ä ÏãúÏûë</button>
                    </div>
                </div>
            </div>

            <!-- Í∞úÎ≥Ñ Í≥ºÏ†ú ÌèâÍ∞Ä Îã®Í≥ÑÎì§ -->
            <div id="evaluationSteps" style="display: none;">
                <!-- ÏßÑÌñâÎ•† ÌëúÏãú -->
                <div class="step-info">
                    <h3 id="stepTitle">1/8 - ITÏ†ÑÎûµÏã§</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 12.5%;"></div>
                    </div>
                    <p id="stepDescription">ITÏ†ÑÎûµÏã§Ïùò Ïö∞ÏàòÍ≥ºÏ†úÎ•º ÌèâÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî.</p>
                </div>

                <!-- ÌèâÍ∞ÄÏûê Ï†ïÎ≥¥ ÌëúÏãú -->
                <div class="evaluator-info" id="evaluatorInfo">
                    <!-- ÌèâÍ∞ÄÏûê Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>

                <!-- ÌèâÍ∞Ä Ìèº -->
                <div class="evaluation-form">
                    <h3 id="currentTeamTitle">ITÏ†ÑÎûµÏã§ ÌèâÍ∞Ä</h3>
                    
                    <div class="criteria-grid">
                        <div class="criteria-item">
                            <div class="criteria-header">
                                <span class="criteria-title">Ï∞ΩÏùòÏÑ±</span>
                                <span class="criteria-max">18~30Ï†ê</span>
                            </div>
                            <input type="number" class="score-input" id="creativity" min="18" max="30" placeholder="18-30Ï†ê">
                            <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÏµúÏÜå 18Ï†ê ~ ÏµúÎåÄ 30Ï†ê</div>
                        </div>

                        <div class="criteria-item">
                            <div class="criteria-header">
                                <span class="criteria-title">ÎÇúÏù¥ÎèÑ</span>
                                <span class="criteria-max">18~30Ï†ê</span>
                            </div>
                            <input type="number" class="score-input" id="difficulty" min="18" max="30" placeholder="18-30Ï†ê">
                            <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÏµúÏÜå 18Ï†ê ~ ÏµúÎåÄ 30Ï†ê</div>
                        </div>

                        <div class="criteria-item">
                            <div class="criteria-header">
                                <span class="criteria-title">Ìö®Í≥ºÏÑ±</span>
                                <span class="criteria-max">12~20Ï†ê</span>
                            </div>
                            <input type="number" class="score-input" id="effectiveness" min="12" max="20" placeholder="12-20Ï†ê">
                            <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÏµúÏÜå 12Ï†ê ~ ÏµúÎåÄ 20Ï†ê</div>
                        </div>

                        <div class="criteria-item">
                            <div class="criteria-header">
                                <span class="criteria-title">Ï†ÑÌååÏÑ±</span>
                                <span class="criteria-max">6~10Ï†ê</span>
                            </div>
                            <input type="number" class="score-input" id="propagation" min="6" max="10" placeholder="6-10Ï†ê">
                            <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÏµúÏÜå 6Ï†ê ~ ÏµúÎåÄ 10Ï†ê</div>
                        </div>

                        <div class="criteria-item">
                            <div class="criteria-header">
                                <span class="criteria-title">Í∏∞Ïó¨ÎèÑ</span>
                                <span class="criteria-max">6~10Ï†ê</span>
                            </div>
                            <input type="number" class="score-input" id="contribution" min="6" max="10" placeholder="6-10Ï†ê">
                            <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÏµúÏÜå 6Ï†ê ~ ÏµúÎåÄ 10Ï†ê</div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="previousStep()" id="prevBtn" style="display: none;">Ïù¥Ï†Ñ</button>
                        <button class="btn btn-primary" onclick="nextStep()" id="nextBtn">Îã§Ïùå Í≥ºÏ†ú</button>
                        <button class="btn btn-primary" onclick="showSummary()" id="summaryBtn" style="display: none;">ÌèâÍ∞Ä ÏôÑÎ£å</button>
                    </div>
                </div>
            </div>

            <!-- ÌèâÍ∞Ä ÏöîÏïΩ Î∞è Ï†úÏ∂ú Îã®Í≥Ñ -->
            <div id="summaryStep" style="display: none;">
                <h2 style="margin-bottom: 20px; color: #333;">ÌèâÍ∞Ä ÏöîÏïΩ Î∞è Ï†úÏ∂ú</h2>
                
                <div class="evaluator-info" id="summaryEvaluatorInfo">
                    <!-- ÌèâÍ∞ÄÏûê Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>

                <div id="evaluationSummaryContainer">
                    <!-- ÌèâÍ∞Ä ÏöîÏïΩÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="backToEvaluation()">ÏàòÏ†ïÌïòÍ∏∞</button>
                    <button class="btn btn-primary" onclick="submitAllEvaluations()">ÏµúÏ¢Ö Ï†úÏ∂ú</button>
                </div>
            </div>
        </div>

        <!-- Ïã§ÏãúÍ∞Ñ Í≤∞Í≥º ÌÉ≠ -->
        <div id="results" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalEvaluations">0</div>
                    <div class="stat-label">Ï¥ù ÌèâÍ∞Ä Ïàò</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="executiveEvaluations">0</div>
                    <div class="stat-label">ÏûÑÏõê ÌèâÍ∞Ä</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="employeeEvaluations">0</div>
                    <div class="stat-label">ÏßÅÏõê ÌèâÍ∞Ä</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completionRate">0%</div>
                    <div class="stat-label">ÏôÑÎ£åÏú®</div>
                </div>
            </div>

            <h2 style="margin-bottom: 20px; color: #333;">üèÜ 2025ÎÖÑÎèÑ ÏÉÅÎ∞òÍ∏∞ ÏÑúÏãúÍ≥µ Ïñ¥ÏõåÎìú Ïã§ÏãúÍ∞Ñ ÏàúÏúÑ</h2>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>ÏàúÏúÑ</th>
                        <th>Î∂ÄÏÑúÎ™Ö</th>
                        <th>ÏµúÏ¢Ö Ï†êÏàò</th>
                        <th>ÏûÑÏõê Ï†êÏàò</th>
                        <th>ÏßÅÏõê Ï†êÏàò</th>
                        <th>Ï¥ù ÌèâÍ∞ÄÏûê</th>
                    </tr>
                </thead>
                <tbody id="resultsTableBody">
                    <!-- Í≤∞Í≥ºÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </tbody>
            </table>
        </div>

        <!-- ÌòÑÌô© Î™®ÎãàÌÑ∞ÎßÅ ÌÉ≠ -->
        <div id="monitor" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: #333; margin: 0;">üìä Ïã§ÏãúÍ∞Ñ ÌèâÍ∞Ä ÌòÑÌô© Î™®ÎãàÌÑ∞ÎßÅ</h2>
                <div>
                    <button class="btn btn-primary" onclick="updateMonitor()">üîÑ ÏÉàÎ°úÍ≥†Ïπ®</button>
                    <button class="btn btn-secondary" onclick="exportMissingList()">üìã ÎØ∏ÏôÑÎ£åÏûê Î™ÖÎã® Ï∂úÎ†•</button>
                </div>
            </div>

            <!-- Ï†ÑÏ≤¥ ÏßÑÌñâÎ•† -->
            <div class="progress-overview" style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                <h3 style="margin-bottom: 20px; color: #4CAF50;">üìà Ï†ÑÏ≤¥ ÏßÑÌñâ ÌòÑÌô©</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div class="progress-card">
                        <div class="progress-number" id="overallProgress">0%</div>
                        <div class="progress-label">Ï†ÑÏ≤¥ ÏôÑÎ£åÏú®</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="executiveProgress">0%</div>
                        <div class="progress-label">ÏûÑÏõê ÏôÑÎ£åÏú®</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="employeeProgress">0%</div>
                        <div class="progress-label">ÏßÅÏõê ÏôÑÎ£åÏú®</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="lastUpdate">-</div>
                        <div class="progress-label">ÎßàÏßÄÎßâ ÏóÖÎç∞Ïù¥Ìä∏</div>
                    </div>
                </div>
            </div>

            <!-- Î∂ÄÏÑúÎ≥Ñ ÌèâÍ∞Ä ÌòÑÌô© -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <!-- ÏûÑÏõê ÌèâÍ∞Ä ÌòÑÌô© -->
                <div class="monitor-section">
                    <h3 style="color: #4CAF50; margin-bottom: 15px;">üëî ÏûÑÏõê ÌèâÍ∞Ä ÌòÑÌô©</h3>
                    <div id="executiveStatus" class="status-grid">
                        <!-- ÏûÑÏõêÎ≥Ñ ÌèâÍ∞Ä ÌòÑÌô©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãú -->
                    </div>
                </div>

                <!-- ÏßÅÏõê ÌèâÍ∞Ä ÌòÑÌô© (Î∂ÄÏÑúÎ≥Ñ) -->
                <div class="monitor-section">
                    <h3 style="color: #4CAF50; margin-bottom: 15px;">üë• ÏßÅÏõê ÌèâÍ∞Ä ÌòÑÌô© (Î∂ÄÏÑúÎ≥Ñ)</h3>
                    <div id="departmentStatus" class="status-grid">
                        <!-- Î∂ÄÏÑúÎ≥Ñ ÌèâÍ∞Ä ÌòÑÌô©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãú -->
                    </div>
                </div>
            </div>

            <!-- Î∞úÌëúÌåÄÎ≥Ñ ÌèâÍ∞Ä ÏôÑÎ£å ÌòÑÌô© -->
            <div class="monitor-section">
                <h3 style="color: #4CAF50; margin-bottom: 15px;">üéØ Î∞úÌëúÌåÄÎ≥Ñ ÌèâÍ∞Ä ÏôÑÎ£å ÌòÑÌô©</h3>
                <div class="team-status-grid" id="teamStatusGrid">
                    <!-- Î∞úÌëúÌåÄÎ≥Ñ ÌòÑÌô©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãú -->
                </div>
            </div>

            <!-- ÏµúÍ∑º ÌèâÍ∞Ä ÌôúÎèô Î°úÍ∑∏ -->
            <div class="monitor-section" style="margin-top: 30px;">
                <h3 style="color: #4CAF50; margin-bottom: 15px;">üìù ÏµúÍ∑º ÌèâÍ∞Ä ÌôúÎèô (Ïã§ÏãúÍ∞Ñ)</h3>
                <div id="recentActivity" style="background: white; border-radius: 10px; max-height: 300px; overflow-y: auto;">
                    <!-- ÏµúÍ∑º ÌôúÎèôÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãú -->
                </div>
            </div>
        </div>

        <!-- ÌèâÍ∞Ä Í¥ÄÎ¶¨ ÌÉ≠ -->
        <div id="management" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #333;">ÌèâÍ∞Ä Í¥ÄÎ¶¨</h2>
            
            <div style="margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="exportResults()">Í≤∞Í≥º ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                <button class="btn btn-secondary" onclick="printResults()">Í≤∞Í≥º Ïù∏ÏáÑ</button>
                <button class="btn btn-danger" onclick="resetAllData()">Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî</button>
            </div>

            <h3 style="margin-bottom: 15px; color: #333;">ÌèâÍ∞Ä ÌòÑÌô©</h3>
            <div id="evaluationStatus"></div>
        </div>
    </div>

    <script>
        // ÌéòÏù¥ÏßÄ Î™®Îìú ÌôïÏù∏ (Í¥ÄÎ¶¨ÏûêÏö© vs ÌèâÍ∞ÄÎã®Ïö©)
        const urlParams = new URLSearchParams(window.location.search);
        const isAdminMode = urlParams.get('admin') === 'true';

        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå
        let evaluations = {};
        let presentingDepts = ['ITÏ†ÑÎûµÏã§', 'Ïû•Ïï†Ïù∏ÏΩúÌÉùÏãúÏö¥ÏòÅÏ≤ò', 'ÏÑúÏö∏Ïñ¥Î¶∞Ïù¥ÎåÄÍ≥µÏõê', 'Ï≤≠Í≥ÑÏ≤úÍ¥ÄÎ¶¨Ï≤ò', 'ÏûêÏÇ∞Í¥ÄÎ¶¨ÌòÅÏã†Ï≤ò', 'Í≥µÏÇ¨Í∞êÎèÖ1Ï≤ò', 'Ï£ºÏ∞®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò', 'Í≥µÍ≥µÏûêÏ†ÑÍ±∞Ïö¥ÏòÅÏ≤ò'];
        
        // ÌòÑÏû¨ ÌèâÍ∞Ä ÏÑ∏ÏÖò Îç∞Ïù¥ÌÑ∞
        let currentEvaluator = {};
        let currentEvaluations = {};
        let currentStep = 0;
        let availableTeams = [];

        // Ï†ÑÏ≤¥ Î∂ÄÏÑú Î™©Î°ù
        let allDepartments = [
            'Í∞êÏÇ¨Ïã§', 'Í∏∞ÌöçÏ°∞Ï†ïÏã§', 'Ïù∏ÏÇ¨ÎÖ∏Î¨¥Ï≤ò', 'Ï¥ùÎ¨¥Ï≤ò', 'ÌôçÎ≥¥Ïã§', 'Ïù∏Ïû¨Î¨∏ÌôîÏõê', 'ITÏ†ÑÎûµÏã§', 'ÏïàÏ†ÑÏ≤ò',
            'ÏÉÅÍ∞ÄÏö¥ÏòÅÏ≤ò', 'Ï∂îÎ™®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò', 'Ïû•Ïï†Ïù∏ÏΩúÌÉùÏãúÏö¥ÏòÅÏ≤ò',
            'ÏÑúÏö∏ÏõîÎìúÏªµÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò', 'ÎèîÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò', 'ÏÑúÏö∏Ïñ¥Î¶∞Ïù¥ÎåÄÍ≥µÏõê', 'Ï≤≠Í≥ÑÏ≤úÍ¥ÄÎ¶¨Ï≤ò', 'ÎÇ®ÏÇ∞Í≥§ÎèåÎùºÏù∏ÏàòÎã®TF',
            'ÏûêÏÇ∞Í¥ÄÎ¶¨ÌòÅÏã†Ï≤ò', 'ÎèÑÎ°úÍ¥ÄÎ¶¨Ï≤ò', 'ÎèÑÎ°úÏãúÏÑ§Ï≤ò', 'ÎèÑÎ°úÍ∏∞Ï†ÑÏ≤ò', 'ÎèÑÎ°úÌôòÍ≤ΩÏ≤ò', 'ÍµêÌÜµÏ†ïÎ≥¥Ï≤ò',
            'Í≥µÏÇ¨Í∞êÎèÖ1Ï≤ò', 'Í≥µÏÇ¨Í∞êÎèÖ2Ï≤ò', 'Í≥µÏÇ¨Í∞êÎèÖ3Ï≤ò', 'Í≥µÎèôÍµ¨Í¥ÄÎ¶¨Ï≤ò', 'ÏÉÅÏàòÎèÑÏßÄÏõêÏ≤ò',
            'Ï£ºÏ∞®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò', 'ÍµêÌÜµÏãúÏÑ§Ïö¥ÏòÅÏ≤ò', 'Í≥µÍ≥µÏûêÏ†ÑÍ±∞Ïö¥ÏòÅÏ≤ò'
        ];
        
        // ÏûÑÏõê Î™©Î°ù
        let executives = ['Ïù¥ÏÇ¨Ïû•', 'Í≤ΩÏòÅÏ†ÑÎûµÎ≥∏Î∂ÄÏû•', 'Î≥µÏßÄÍ≤ΩÏ†úÎ≥∏Î∂ÄÏû•', 'Î¨∏ÌôîÏ≤¥Ïú°Î≥∏Î∂ÄÏû•', 'ÎèÑÎ°úÍ¥ÄÎ¶¨Î≥∏Î∂ÄÏû•', 'ÏãúÏÑ§ÏïàÏ†ÑÎ≥∏Î∂ÄÏû•', 'ÍµêÌÜµÏÇ¨ÏóÖÎ≥∏Î∂ÄÏû•'];
        
        // Î≥∏Î∂ÄÎ≥Ñ ÏÜåÏÜç Î∂ÄÏÑú Îß§Ìïë
        let divisionMapping = {
            'Í≤ΩÏòÅÏ†ÑÎûµÎ≥∏Î∂ÄÏû•': ['Í∞êÏÇ¨Ïã§', 'Í∏∞ÌöçÏ°∞Ï†ïÏã§', 'Ïù∏ÏÇ¨ÎÖ∏Î¨¥Ï≤ò', 'Ï¥ùÎ¨¥Ï≤ò', 'ÌôçÎ≥¥Ïã§', 'Ïù∏Ïû¨Î¨∏ÌôîÏõê', 'ITÏ†ÑÎûµÏã§', 'ÏïàÏ†ÑÏ≤ò'],
            'Î≥µÏßÄÍ≤ΩÏ†úÎ≥∏Î∂ÄÏû•': ['ÏÉÅÍ∞ÄÏö¥ÏòÅÏ≤ò', 'Ï∂îÎ™®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò', 'Ïû•Ïï†Ïù∏ÏΩúÌÉùÏãúÏö¥ÏòÅÏ≤ò'],
            'Î¨∏ÌôîÏ≤¥Ïú°Î≥∏Î∂ÄÏû•': ['ÏÑúÏö∏ÏõîÎìúÏªµÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò', 'ÎèîÍ≤ΩÍ∏∞Ïû•Ïö¥ÏòÅÏ≤ò', 'ÏÑúÏö∏Ïñ¥Î¶∞Ïù¥ÎåÄÍ≥µÏõê', 'Ï≤≠Í≥ÑÏ≤úÍ¥ÄÎ¶¨Ï≤ò', 'ÎÇ®ÏÇ∞Í≥§ÎèåÎùºÏù∏ÏàòÎã®TF'],
            'ÎèÑÎ°úÍ¥ÄÎ¶¨Î≥∏Î∂ÄÏû•': ['ÏûêÏÇ∞Í¥ÄÎ¶¨ÌòÅÏã†Ï≤ò', 'ÎèÑÎ°úÍ¥ÄÎ¶¨Ï≤ò', 'ÎèÑÎ°úÏãúÏÑ§Ï≤ò', 'ÎèÑÎ°úÍ∏∞Ï†ÑÏ≤ò', 'ÎèÑÎ°úÌôòÍ≤ΩÏ≤ò', 'ÍµêÌÜµÏ†ïÎ≥¥Ï≤ò'],
            'ÏãúÏÑ§ÏïàÏ†ÑÎ≥∏Î∂ÄÏû•': ['Í≥µÏÇ¨Í∞êÎèÖ1Ï≤ò', 'Í≥µÏÇ¨Í∞êÎèÖ2Ï≤ò', 'Í≥µÏÇ¨Í∞êÎèÖ3Ï≤ò', 'Í≥µÎèôÍµ¨Í¥ÄÎ¶¨Ï≤ò', 'ÏÉÅÏàòÎèÑÏßÄÏõêÏ≤ò'],
            'ÍµêÌÜµÏÇ¨ÏóÖÎ≥∏Î∂ÄÏû•': ['Ï£ºÏ∞®ÏãúÏÑ§Ïö¥ÏòÅÏ≤ò', 'ÍµêÌÜµÏãúÏÑ§Ïö¥ÏòÅÏ≤ò', 'Í≥µÍ≥µÏûêÏ†ÑÍ±∞Ïö¥ÏòÅÏ≤ò']
        };

        // Í∞Å Î∞úÌëúÌåÄÏù¥ ÏÜçÌïú Î≥∏Î∂Ä Ï∞æÍ∏∞
        function getDivisionByDept(dept) {
            for (let division in divisionMapping) {
                if (divisionMapping[division].includes(dept)) {
                    return division;
                }
            }
            return null;
        }

        // ÌèâÍ∞ÄÏûê Íµ¨Î∂ÑÏóê Îî∞Î•∏ ÏòµÏÖò ÏóÖÎç∞Ïù¥Ìä∏
        function updateEvaluatorOptions() {
            const evaluatorType = document.getElementById('evaluatorType').value;
            const departmentGroup = document.getElementById('departmentGroup');
            const executiveGroup = document.getElementById('executiveGroup');
            const evaluatorNameGroup = document.getElementById('evaluatorNameGroup');
            const evaluatorNameInput = document.getElementById('evaluatorName');
            
            // Î™®Îì† Í∑∏Î£π Ïà®Í∏∞Í∏∞
            departmentGroup.style.display = 'none';
            executiveGroup.style.display = 'none';
            
            // ÌèâÍ∞ÄÏûêÎ™Ö ÌïÑÎìú Ï≤òÎ¶¨
            if (evaluatorType === 'chairman' || evaluatorType === 'executive') {
                evaluatorNameGroup.style.display = 'none';
                evaluatorNameInput.value = evaluatorType === 'chairman' ? 'Ïù¥ÏÇ¨Ïû•' : '';
            } else {
                evaluatorNameGroup.style.display = 'block';
                evaluatorNameInput.value = '';
            }
            
            if (evaluatorType === 'employee') {
                departmentGroup.style.display = 'block';
            } else if (evaluatorType === 'executive') {
                executiveGroup.style.display = 'block';
                document.getElementById('executivePosition').addEventListener('change', function() {
                    // Î≥∏Î∂ÄÏû• ÏÑ†ÌÉù Ïãú ÌèâÍ∞ÄÏûêÎ™Ö ÏûêÎèô ÏÑ§Ï†ï
                    const selectedPosition = this.value;
                    if (selectedPosition) {
                        evaluatorNameInput.value = selectedPosition;
                    }
                });
            }
        }

        // ÌèâÍ∞Ä ÏãúÏûë
        function startEvaluation() {
            const evaluatorType = document.getElementById('evaluatorType').value;
            const evaluatorName = document.getElementById('evaluatorName').value;
            const evaluatorDept = document.getElementById('evaluatorDept').value;
            const executivePosition = document.getElementById('executivePosition').value;

            // ÏûÖÎ†• Í≤ÄÏ¶ù
            if (!evaluatorType) {
                alert('ÌèâÍ∞ÄÏûê Íµ¨Î∂ÑÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (evaluatorType === 'employee' && (!evaluatorDept || !evaluatorName)) {
                alert('ÏßÅÏõê ÌèâÍ∞ÄÏûêÎäî ÏÜåÏÜç Î∂ÄÏÑúÏôÄ ÌèâÍ∞ÄÏûêÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (evaluatorType === 'executive' && !executivePosition) {
                alert('Î≥∏Î∂ÄÏû•ÏùÄ ÏÜåÏÜçÎ≥∏Î∂ÄÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // ÌèâÍ∞ÄÏûê Ï†ïÎ≥¥ Ï†ÄÏû•
            currentEvaluator = {
                evaluatorType,
                evaluatorName,
                evaluatorDept,
                executivePosition
            };

            // ÌèâÍ∞Ä Í∞ÄÎä•Ìïú ÌåÄ Í≥ÑÏÇ∞
            availableTeams = presentingDepts.filter(dept => {
                if (evaluatorType === 'chairman') {
                    return true;
                } else if (evaluatorType === 'executive') {
                    const deptDivision = getDivisionByDept(dept);
                    return executivePosition !== deptDivision;
                } else if (evaluatorType === 'employee') {
                    return evaluatorDept !== dept;
                }
                return false;
            });

            if (availableTeams.length === 0) {
                alert('ÌèâÍ∞Ä Í∞ÄÎä•Ìïú Í≥ºÏ†úÍ∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }

            // ÌèâÍ∞Ä Îã®Í≥Ñ ÏãúÏûë
            currentStep = 0;
            currentEvaluations = {};
            
            document.getElementById('evaluatorInfoStep').style.display = 'none';
            document.getElementById('evaluationSteps').style.display = 'block';
            
            updateEvaluatorInfoDisplay();
            updateStepDisplay();
        }

        // ÌèâÍ∞ÄÏûê Ï†ïÎ≥¥ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateEvaluatorInfoDisplay() {
            const info = currentEvaluator;
            let infoText = '';
            
            if (info.evaluatorType === 'chairman') {
                infoText = '<strong>ÌèâÍ∞ÄÏûê:</strong> Ïù¥ÏÇ¨Ïû•';
            } else if (info.evaluatorType === 'executive') {
                infoText = `<strong>ÌèâÍ∞ÄÏûê:</strong> ${info.executivePosition} ${info.evaluatorName}`;
            } else {
                infoText = `<strong>ÌèâÍ∞ÄÏûê:</strong> ${info.evaluatorDept} ${info.evaluatorName}`;
            }
            
            document.getElementById('evaluatorInfo').innerHTML = infoText;
            document.getElementById('summaryEvaluatorInfo').innerHTML = infoText;
        }

        // Îã®Í≥Ñ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateStepDisplay() {
            const currentTeam = availableTeams[currentStep];
            const progress = ((currentStep + 1) / availableTeams.length) * 100;
            
            document.getElementById('stepTitle').textContent = `${currentStep + 1}/${availableTeams.length} - ${currentTeam}`;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('stepDescription').textContent = `${currentTeam}Ïùò Ïö∞ÏàòÍ≥ºÏ†úÎ•º ÌèâÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî.`;
            document.getElementById('currentTeamTitle').textContent = `${currentTeam} ÌèâÍ∞Ä`;
            
            // Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('prevBtn').style.display = currentStep > 0 ? 'inline-block' : 'none';
            document.getElementById('nextBtn').style.display = currentStep < availableTeams.length - 1 ? 'inline-block' : 'none';
            document.getElementById('summaryBtn').style.display = currentStep === availableTeams.length - 1 ? 'inline-block' : 'none';
            
            // Ïù¥ÎØ∏ ÌèâÍ∞ÄÎêú Ï†êÏàòÍ∞Ä ÏûàÎã§Î©¥ ÌëúÏãú
            const currentTeamData = currentEvaluations[currentTeam];
            if (currentTeamData) {
                document.getElementById('creativity').value = currentTeamData.creativity;
                document.getElementById('difficulty').value = currentTeamData.difficulty;
                document.getElementById('effectiveness').value = currentTeamData.effectiveness;
                document.getElementById('propagation').value = currentTeamData.propagation;
                document.getElementById('contribution').value = currentTeamData.contribution;
            } else {
                // Ìèº Ï¥àÍ∏∞Ìôî
                document.getElementById('creativity').value = '';
                document.getElementById('difficulty').value = '';
                document.getElementById('effectiveness').value = '';
                document.getElementById('propagation').value = '';
                document.getElementById('contribution').value = '';
            }
        }

        // ÌòÑÏû¨ Îã®Í≥Ñ Ï†êÏàò Ï†ÄÏû•
        function saveCurrentStep() {
            const currentTeam = availableTeams[currentStep];
            const creativity = parseInt(document.getElementById('creativity').value) || 0;
            const difficulty = parseInt(document.getElementById('difficulty').value) || 0;
            const effectiveness = parseInt(document.getElementById('effectiveness').value) || 0;
            const propagation = parseInt(document.getElementById('propagation').value) || 0;
            const contribution = parseInt(document.getElementById('contribution').value) || 0;

            // Ï†êÏàò Í≤ÄÏ¶ù
            if (creativity < 18 || creativity > 30) {
                alert('Ï∞ΩÏùòÏÑ± Ï†êÏàòÎäî 18Ï†ê~30Ï†ê ÏÇ¨Ïù¥Ïó¨Ïïº Ìï©ÎãàÎã§.');
                return false;
            }
            if (difficulty < 18 || difficulty > 30) {
                alert('ÎÇúÏù¥ÎèÑ Ï†êÏàòÎäî 18Ï†ê~30Ï†ê ÏÇ¨Ïù¥Ïó¨Ïïº Ìï©ÎãàÎã§.');
                return false;
            }
            if (effectiveness < 12 || effectiveness > 20) {
                alert('Ìö®Í≥ºÏÑ± Ï†êÏàòÎäî 12Ï†ê~20Ï†ê ÏÇ¨Ïù¥Ïó¨Ïïº Ìï©ÎãàÎã§.');
                return false;
            }
            if (propagation < 6 || propagation > 10) {
                alert('Ï†ÑÌååÏÑ± Ï†êÏàòÎäî 6Ï†ê~10Ï†ê ÏÇ¨Ïù¥Ïó¨Ïïº Ìï©ÎãàÎã§.');
                return false;
            }
            if (contribution < 6 || contribution > 10) {
                alert('Í∏∞Ïó¨ÎèÑ Ï†êÏàòÎäî 6Ï†ê~10Ï†ê ÏÇ¨Ïù¥Ïó¨Ïïº Ìï©ÎãàÎã§.');
                return false;
            }

            const totalScore = creativity + difficulty + effectiveness + propagation + contribution;
            
            currentEvaluations[currentTeam] = {
                creativity,
                difficulty,
                effectiveness,
                propagation,
                contribution,
                totalScore
            };
            
            return true;
        }

        // Îã§Ïùå Îã®Í≥Ñ
        function nextStep() {
            if (!saveCurrentStep()) return;
            
            currentStep++;
            updateStepDisplay();
        }

        // Ïù¥Ï†Ñ Îã®Í≥Ñ
        function previousStep() {
            saveCurrentStep(); // ÌòÑÏû¨ Ï†êÏàò Ï†ÄÏû• (Í≤ÄÏ¶ù ÏóÜÏù¥)
            
            currentStep--;
            updateStepDisplay();
        }

        // ÏöîÏïΩ ÌëúÏãú
        function showSummary() {
            if (!saveCurrentStep()) return;
            
            document.getElementById('evaluationSteps').style.display = 'none';
            document.getElementById('summaryStep').style.display = 'block';
            
            // ÏöîÏïΩ ÏÉùÏÑ±
            let summaryHTML = '';
            let totalSum = 0;
            
            availableTeams.forEach(team => {
                const data = currentEvaluations[team];
                if (data) {
                    summaryHTML += `
                        <div class="evaluation-summary">
                            <h4 style="color: #4CAF50; margin-bottom: 15px;">${team}</h4>
                            <div class="summary-item">
                                <span>Ï∞ΩÏùòÏÑ±</span>
                                <span class="summary-score">${data.creativity}Ï†ê</span>
                            </div>
                            <div class="summary-item">
                                <span>ÎÇúÏù¥ÎèÑ</span>
                                <span class="summary-score">${data.difficulty}Ï†ê</span>
                            </div>
                            <div class="summary-item">
                                <span>Ìö®Í≥ºÏÑ±</span>
                                <span class="summary-score">${data.effectiveness}Ï†ê</span>
                            </div>
                            <div class="summary-item">
                                <span>Ï†ÑÌååÏÑ±</span>
                                <span class="summary-score">${data.propagation}Ï†ê</span>
                            </div>
                            <div class="summary-item">
                                <span>Í∏∞Ïó¨ÎèÑ</span>
                                <span class="summary-score">${data.contribution}Ï†ê</span>
                            </div>
                            <div class="summary-item" style="border-top: 2px solid #4CAF50; font-weight: bold;">
                                <span>Ï¥ùÏ†ê</span>
                                <span class="summary-score" style="font-size: 1.2em;">${data.totalScore}Ï†ê</span>
                            </div>
                        </div>
                    `;
                    totalSum += data.totalScore;
                }
            });
            
            summaryHTML += `
                <div style="text-align: center; margin: 20px 0; padding: 20px; background: #e8f5e8; border-radius: 10px;">
                    <h3 style="color: #4CAF50;">Ï†ÑÏ≤¥ ÌèâÍ∞Ä ÏôÑÎ£å</h3>
                    <p style="font-size: 1.1em; margin: 10px 0;">
                        Ï¥ù <strong>${availableTeams.length}Í∞ú</strong> Í≥ºÏ†ú ÌèâÍ∞Ä / 
                        Ï†ÑÏ≤¥ Ìï©Í≥Ñ: <strong style="color: #4CAF50; font-size: 1.3em;">${totalSum}Ï†ê</strong>
                    </p>
                </div>
            `;
            
            document.getElementById('evaluationSummaryContainer').innerHTML = summaryHTML;
        }

        // ÌèâÍ∞ÄÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
        function backToEvaluation() {
            document.getElementById('summaryStep').style.display = 'none';
            document.getElementById('evaluationSteps').style.display = 'block';
        }

        // ÏµúÏ¢Ö Ï†úÏ∂ú
        function submitAllEvaluations() {
            if (Object.keys(currentEvaluations).length !== availableTeams.length) {
                alert('Î™®Îì† Í≥ºÏ†ú ÌèâÍ∞ÄÎ•º ÏôÑÎ£åÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // Ï†ÑÏ≤¥ ÌèâÍ∞Ä Îç∞Ïù¥ÌÑ∞Î•º Í∞úÎ≥ÑÏ†ÅÏúºÎ°ú Ï†ÄÏû•
            availableTeams.forEach(team => {
                const evaluationData = currentEvaluations[team];
                const evaluationId = `${currentEvaluator.evaluatorType}_${currentEvaluator.evaluatorName}_${team}_${Date.now()}`;
                
                evaluations[evaluationId] = {
                    ...currentEvaluator,
                    team: team,
                    scores: {
                        creativity: evaluationData.creativity,
                        difficulty: evaluationData.difficulty,
                        effectiveness: evaluationData.effectiveness,
                        propagation: evaluationData.propagation,
                        contribution: evaluationData.contribution
                    },
                    totalScore: evaluationData.totalScore,
                    timestamp: new Date().toISOString()
                };
            });

            alert(`üéâ Î™®Îì† ÌèâÍ∞ÄÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†úÏ∂úÎêòÏóàÏäµÎãàÎã§!\n\nÏ¥ù ${availableTeams.length}Í∞ú Í≥ºÏ†ú ÌèâÍ∞Ä ÏôÑÎ£å\nÍ∞êÏÇ¨Ìï©ÎãàÎã§!`);
            
            // ÌèâÍ∞Ä ÏôÑÎ£å ÌõÑ Ï¥àÍ∏∞Ìôî
            resetEvaluationForm();
        }

        // ÌèâÍ∞Ä Ìèº Ï¥àÍ∏∞Ìôî
        function resetEvaluationForm() {
            currentEvaluator = {};
            currentEvaluations = {};
            currentStep = 0;
            availableTeams = [];
            
            document.getElementById('evaluatorType').value = '';
            document.getElementById('evaluatorName').value = '';
            document.getElementById('evaluatorDept').value = '';
            document.getElementById('executivePosition').value = '';
            document.getElementById('departmentGroup').style.display = 'none';
            document.getElementById('executiveGroup').style.display = 'none';
            document.getElementById('evaluatorNameGroup').style.display = 'block';
            
            document.getElementById('summaryStep').style.display = 'none';
            document.getElementById('evaluationSteps').style.display = 'none';
            document.getElementById('evaluatorInfoStep').style.display = 'block';
        }

        // ÌÉ≠ Ï†ÑÌôò
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'results') {
                updateResults();
            } else if (tabName === 'management') {
                updateManagement();
            } else if (tabName === 'monitor') {
                updateMonitor();
            }
        }

        // QRÏΩîÎìú Î∞è URL ÏóÖÎç∞Ïù¥Ìä∏
        function updateQRCode() {
            const currentURL = window.location.href.split('?')[0];
            const qrImg = document.getElementById('mainQRCode');
            const urlDiv = document.getElementById('currentURL');
            
            if (qrImg) {
                qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(currentURL)}`;
            }
            if (urlDiv) {
                urlDiv.textContent = currentURL;
            }
        }

        // ÎßÅÌÅ¨ Î≥µÏÇ¨
        function copyMainLink() {
            const url = window.location.href.split('?')[0];
            navigator.clipboard.writeText(url).then(() => {
                alert('üìã ÎßÅÌÅ¨Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!\n\n' + url);
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('üìã ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!\n\n' + url);
            });
        }

        // Í≥µÏú†ÌïòÍ∏∞
        function shareMainLink() {
            const url = window.location.href.split('?')[0];
            const title = '2025ÎÖÑÎèÑ ÏÉÅÎ∞òÍ∏∞ ÏÑúÏãúÍ≥µ Ïñ¥ÏõåÎìú Ïö∞ÏàòÍ≥ºÏ†ú ÌèâÍ∞Ä';
            const description = 'Ïö∞ÏàòÍ≥ºÏ†ú Î∞úÌëú ÌèâÍ∞ÄÏóê Ï∞∏Ïó¨Ìï¥Ï£ºÏÑ∏Ïöî!';
            
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: description,
                    url: url
                });
            } else {
                copyMainLink();
            }
        }

        // ÌéòÏù¥ÏßÄ Î™®ÎìúÏóê Îî∞Î•∏ ÌÉ≠ ÌëúÏãú/Ïà®ÍπÄ
        function initializePageMode() {
            if (isAdminMode) {
                document.getElementById('resultsTab').style.display = 'block';
                document.getElementById('monitorTab').style.display = 'block';
                document.getElementById('managementTab').style.display = 'block';
                
                const header = document.querySelector('.header h1');
                header.innerHTML = '2025ÎÖÑÎèÑ ÏÉÅÎ∞òÍ∏∞ ÏÑúÏãúÍ≥µ Ïñ¥ÏõåÎìú <span style="background: #ff4444; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.6em; margin-left: 10px;">Í¥ÄÎ¶¨Ïûê</span>';
            } else {
                document.getElementById('resultsTab').style.display = 'none';
                document.getElementById('monitorTab').style.display = 'none';
                document.getElementById('managementTab').style.display = 'none';
            }
        }

        // Í≤∞Í≥º ÏóÖÎç∞Ïù¥Ìä∏ (Í∏∞Ï°¥ Ìï®ÏàòÎì§)
        function updateResults() {
            const deptScores = {};
            
            presentingDepts.forEach(dept => {
                deptScores[dept] = {
                    executiveScores: [],
                    employeeScores: [],
                    executiveAvg: 0,
                    employeeAvg: 0,
                    finalScore: 0
                };
            });

            Object.values(evaluations).forEach(evaluation => {
                const dept = evaluation.team;
                if (evaluation.evaluatorType === 'chairman' || evaluation.evaluatorType === 'executive') {
                    deptScores[dept].executiveScores.push(evaluation.totalScore);
                } else {
                    deptScores[dept].employeeScores.push(evaluation.totalScore);
                }
            });

            presentingDepts.forEach(dept => {
                const deptData = deptScores[dept];
                
                if (deptData.executiveScores.length > 0) {
                    deptData.executiveAvg = deptData.executiveScores.reduce((a, b) => a + b, 0) / deptData.executiveScores.length;
                }
                
                if (deptData.employeeScores.length > 0) {
                    deptData.employeeAvg = deptData.employeeScores.reduce((a, b) => a + b, 0) / deptData.employeeScores.length;
                }
                
                deptData.finalScore = (deptData.executiveAvg * 0.6) + (deptData.employeeAvg * 0.4);
            });

            const sortedDepts = presentingDepts.sort((a, b) => deptScores[b].finalScore - deptScores[a].finalScore);

            const tbody = document.getElementById('resultsTableBody');
            tbody.innerHTML = '';

            sortedDepts.forEach((dept, index) => {
                const deptData = deptScores[dept];
                const rank = index + 1;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <span class="rank-badge rank-${rank <= 3 ? rank : 'other'}">
                            ${rank}ÏúÑ
                        </span>
                    </td>
                    <td>${dept}</td>
                    <td><strong>${deptData.finalScore.toFixed(1)}Ï†ê</strong></td>
                    <td>${deptData.executiveAvg.toFixed(1)}Ï†ê (${deptData.executiveScores.length}Î™Ö)</td>
                    <td>${deptData.employeeAvg.toFixed(1)}Ï†ê (${deptData.employeeScores.length}Î™Ö)</td>
                    <td>${deptData.executiveScores.length + deptData.employeeScores.length}Î™Ö</td>
                `;
                tbody.appendChild(row);
            });

            updateStats();
        }

        function updateStats() {
            const totalEvaluations = Object.keys(evaluations).length;
            const executiveEvaluations = Object.values(evaluations).filter(e => e.evaluatorType === 'chairman' || e.evaluatorType === 'executive').length;
            const employeeEvaluations = Object.values(evaluations).filter(e => e.evaluatorType === 'employee').length;
            
            const expectedExecutive = 7 * 8;
            const expectedEmployee = presentingDepts.length * 25;
            const expectedTotal = expectedExecutive + expectedEmployee;
            const completionRate = expectedTotal > 0 ? ((totalEvaluations / expectedTotal) * 100).toFixed(1) : 0;

            document.getElementById('totalEvaluations').textContent = totalEvaluations;
            document.getElementById('executiveEvaluations').textContent = executiveEvaluations;
            document.getElementById('employeeEvaluations').textContent = employeeEvaluations;
            document.getElementById('completionRate').textContent = completionRate + '%';
        }

        // Î™®ÎãàÌÑ∞ÎßÅ ÏóÖÎç∞Ïù¥Ìä∏
        function updateMonitor() {
            updateProgressOverview();
            updateExecutiveStatus();
            updateDepartmentStatus();
            updateTeamStatus();
            updateRecentActivity();
        }

        // Ï†ÑÏ≤¥ ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏
        function updateProgressOverview() {
            const totalEvaluations = Object.keys(evaluations).length;
            const executiveEvals = Object.values(evaluations).filter(e => e.evaluatorType === 'chairman' || e.evaluatorType === 'executive').length;
            const employeeEvals = Object.values(evaluations).filter(e => e.evaluatorType === 'employee').length;
            
            const expectedExecutive = 7 * 8;
            let expectedEmployee = 0;
            presentingDepts.forEach(dept => {
                expectedEmployee += 25;
            });
            const expectedTotal = expectedExecutive + expectedEmployee;

            const overallProgress = expectedTotal > 0 ? ((totalEvaluations / expectedTotal) * 100).toFixed(1) : 0;
            const executiveProgress = expectedExecutive > 0 ? ((executiveEvals / expectedExecutive) * 100).toFixed(1) : 0;
            const employeeProgress = expectedEmployee > 0 ? ((employeeEvals / expectedEmployee) * 100).toFixed(1) : 0;

            document.getElementById('overallProgress').textContent = overallProgress + '%';
            document.getElementById('executiveProgress').textContent = executiveProgress + '%';
            document.getElementById('employeeProgress').textContent = employeeProgress + '%';
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
        }

        // ÏûÑÏõê ÌèâÍ∞Ä ÌòÑÌô© ÏóÖÎç∞Ïù¥Ìä∏
        function updateExecutiveStatus() {
            const executiveStatus = document.getElementById('executiveStatus');
            executiveStatus.innerHTML = '';

            executives.forEach(executive => {
                const evaluationsByExec = Object.values(evaluations).filter(e => 
                    (e.evaluatorType === 'chairman' && executive === 'Ïù¥ÏÇ¨Ïû•') ||
                    (e.evaluatorType === 'executive' && e.executivePosition === executive)
                );

                let expectedCount = 8;
                
                if (executive !== 'Ïù¥ÏÇ¨Ïû•' && divisionMapping[executive]) {
                    const excludedTeams = divisionMapping[executive].filter(dept => presentingDepts.includes(dept));
                    expectedCount = 8 - excludedTeams.length;
                }

                const completedCount = evaluationsByExec.length;

                let statusClass = 'missing';
                let badgeClass = 'badge-missing';
                let statusText = 'ÎØ∏ÏôÑÎ£å';

                if (completedCount === expectedCount && expectedCount > 0) {
                    statusClass = 'completed';
                    badgeClass = 'badge-completed';
                    statusText = 'ÏôÑÎ£å';
                } else if (completedCount > 0) {
                    statusClass = 'partial';
                    badgeClass = 'badge-partial';
                    statusText = `${completedCount}/${expectedCount}`;
                } else if (expectedCount === 0) {
                    statusClass = 'not-applicable';
                    badgeClass = 'badge-na';
                    statusText = 'Ìï¥ÎãπÏóÜÏùå';
                }

                const statusItem = document.createElement('div');
                statusItem.className = `status-item ${statusClass}`;
                statusItem.innerHTML = `
                    <span><strong>${executive}</strong></span>
                    <span class="status-badge ${badgeClass}">${statusText}</span>
                `;
                executiveStatus.appendChild(statusItem);
            });
        }

        // Î∂ÄÏÑúÎ≥Ñ ÏßÅÏõê ÌèâÍ∞Ä ÌòÑÌô© ÏóÖÎç∞Ïù¥Ìä∏
        function updateDepartmentStatus() {
            const departmentStatus = document.getElementById('departmentStatus');
            departmentStatus.innerHTML = '';

            allDepartments.forEach(dept => {
                const employeeEvals = Object.values(evaluations).filter(e => 
                    e.evaluatorType === 'employee' && e.evaluatorDept === dept
                );

                const availableTeams = presentingDepts.filter(team => team !== dept);
                const expectedCount = availableTeams.length;
                const completedCount = employeeEvals.length;

                let statusClass = 'missing';
                let badgeClass = 'badge-missing';
                let statusText = 'ÎØ∏ÏôÑÎ£å';

                if (expectedCount === 0) {
                    statusClass = 'not-applicable';
                    badgeClass = 'badge-na';
                    statusText = 'Ìï¥ÎãπÏóÜÏùå';
                } else if (completedCount >= expectedCount * 0.8) {
                    statusClass = 'completed';
                    badgeClass = 'badge-completed';
                    statusText = `ÌôúÎ∞ú (${completedCount}Î™Ö)`;
                } else if (completedCount > 0) {
                    statusClass = 'partial';
                    badgeClass = 'badge-partial';
                    statusText = `ÏùºÎ∂Ä (${completedCount}Î™Ö)`;
                }

                const statusItem = document.createElement('div');
                statusItem.className = `status-item ${statusClass}`;
                statusItem.innerHTML = `
                    <span><strong>${dept}</strong></span>
                    <span class="status-badge ${badgeClass}">${statusText}</span>
                `;
                departmentStatus.appendChild(statusItem);
            });
        }

        // Î∞úÌëúÌåÄÎ≥Ñ ÌèâÍ∞Ä ÌòÑÌô© ÏóÖÎç∞Ïù¥Ìä∏
        function updateTeamStatus() {
            const teamStatusGrid = document.getElementById('teamStatusGrid');
            teamStatusGrid.innerHTML = '';

            presentingDepts.forEach(team => {
                const teamEvals = Object.values(evaluations).filter(e => e.team === team);
                const executiveEvals = teamEvals.filter(e => e.evaluatorType === 'chairman' || e.evaluatorType === 'executive');
                const employeeEvals = teamEvals.filter(e => e.evaluatorType === 'employee');

                const belongingDivision = getDivisionByDept(team);
                const expectedExecutives = belongingDivision ? 6 : 7;
                const expectedEmployees = 25;

                const execProgress = expectedExecutives > 0 ? ((executiveEvals.length / expectedExecutives) * 100).toFixed(0) : 0;
                const empProgress = expectedEmployees > 0 ? ((employeeEvals.length / expectedEmployees) * 100).toFixed(0) : 0;

                const teamCard = document.createElement('div');
                teamCard.className = 'team-status-card';
                teamCard.innerHTML = `
                    <h4 style="color: #4CAF50; margin-bottom: 15px;">${team}</h4>
                    <div style="margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>üëî ÏûÑÏõê ÌèâÍ∞Ä</span>
                            <span><strong>${executiveEvals.length}/${expectedExecutives}</strong></span>
                        </div>
                        <div style="background: #e0e0e0; border-radius: 10px; height: 8px;">
                            <div style="background: #4CAF50; width: ${execProgress}%; height: 100%; border-radius: 10px; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>üë• ÏßÅÏõê ÌèâÍ∞Ä</span>
                            <span><strong>${employeeEvals.length}</strong>Î™Ö</span>
                        </div>
                        <div style="background: #e0e0e0; border-radius: 10px; height: 8px;">
                            <div style="background: #2196F3; width: ${Math.min(empProgress, 100)}%; height: 100%; border-radius: 10px; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; font-size: 0.9em; color: #666;">
                        Ï¥ù ${teamEvals.length}Í∞ú ÌèâÍ∞Ä ÏôÑÎ£å
                    </div>
                `;
                teamStatusGrid.appendChild(teamCard);
            });
        }

        // ÏµúÍ∑º ÌôúÎèô ÏóÖÎç∞Ïù¥Ìä∏
        function updateRecentActivity() {
            const recentActivity = document.getElementById('recentActivity');
            const sortedEvaluations = Object.values(evaluations)
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 20);

            recentActivity.innerHTML = '';

            if (sortedEvaluations.length === 0) {
                recentActivity.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">ÏïÑÏßÅ ÌèâÍ∞ÄÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            sortedEvaluations.forEach((eval, index) => {
                const time = new Date(eval.timestamp).toLocaleTimeString();
                const evaluatorInfo = eval.evaluatorType === 'employee' ? 
                    `${eval.evaluatorDept} ${eval.evaluatorName}` : 
                    `${eval.evaluatorType === 'chairman' ? 'Ïù¥ÏÇ¨Ïû•' : eval.executivePosition} ${eval.evaluatorName}`;

                const activityItem = document.createElement('div');
                activityItem.className = `activity-item ${index < 3 ? 'blinking' : ''}`;
                activityItem.innerHTML = `
                    <div>
                        <strong>${evaluatorInfo}</strong>Ïù¥(Í∞Ä) <span style="color: #4CAF50;">${eval.team}</span> ÌèâÍ∞Ä ÏôÑÎ£å
                        <div style="font-size: 0.9em; color: #666;">Ï†êÏàò: ${eval.totalScore}Ï†ê</div>
                    </div>
                    <div class="activity-time">${time}</div>
                `;
                recentActivity.appendChild(activityItem);
            });
        }

        // ÎØ∏ÏôÑÎ£åÏûê Î™ÖÎã® Ï∂úÎ†•
        function exportMissingList() {
            let missingList = "2025ÎÖÑÎèÑ ÏÉÅÎ∞òÍ∏∞ ÏÑúÏãúÍ≥µ Ïñ¥ÏõåÎìú ÌèâÍ∞Ä ÎØ∏ÏôÑÎ£åÏûê Î™ÖÎã®\n";
            missingList += "ÏÉùÏÑ±ÏùºÏãú: " + new Date().toLocaleString() + "\n\n";

            missingList += "=== ÏûÑÏõê ÎØ∏ÏôÑÎ£å ÌòÑÌô© ===\n";
            executives.forEach(executive => {
                const evaluationsByExec = Object.values(evaluations).filter(e => 
                    (e.evaluatorType === 'chairman' && executive === 'Ïù¥ÏÇ¨Ïû•') ||
                    (e.evaluatorType === 'executive' && e.executivePosition === executive)
                );

                let expectedCount = 8;
                if (executive !== 'Ïù¥ÏÇ¨Ïû•' && divisionMapping[executive]) {
                    const excludedTeams = divisionMapping[executive].filter(dept => presentingDepts.includes(dept));
                    expectedCount = 8 - excludedTeams.length;
                }

                if (evaluationsByExec.length < expectedCount) {
                    missingList += `${executive}: ${evaluationsByExec.length}/${expectedCount} ÏôÑÎ£å\n`;
                }
            });

            missingList += "\n=== Î∂ÄÏÑúÎ≥Ñ ÏßÅÏõê Ï∞∏Ïó¨ ÌòÑÌô© ===\n";
            allDepartments.forEach(dept => {
                const employeeEvals = Object.values(evaluations).filter(e => 
                    e.evaluatorType === 'employee' && e.evaluatorDept === dept
                );
                const availableTeams = presentingDepts.filter(team => team !== dept);
                
                if (availableTeams.length > 0) {
                    missingList += `${dept}: ${employeeEvals.length}Î™Ö Ï∞∏Ïó¨\n`;
                }
            });

            const blob = new Blob([missingList], { type: 'text/plain;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '2025_ÏÑúÏãúÍ≥µÏñ¥ÏõåÎìú_ÌèâÍ∞Ä_ÎØ∏ÏôÑÎ£åÏûê_Î™ÖÎã®_' + new Date().toISOString().slice(0,16).replace('T', '_') + '.txt';
            link.click();
        }
        function updateManagement() {
            const statusDiv = document.getElementById('evaluationStatus');
            statusDiv.innerHTML = '';

            const evaluationsByDept = {};
            presentingDepts.forEach(dept => {
                evaluationsByDept[dept] = {
                    executive: 0,
                    employee: 0
                };
            });

            Object.values(evaluations).forEach(evaluation => {
                if (evaluation.evaluatorType === 'chairman' || evaluation.evaluatorType === 'executive') {
                    evaluationsByDept[evaluation.team].executive++;
                } else {
                    evaluationsByDept[evaluation.team].employee++;
                }
            });

            presentingDepts.forEach(dept => {
                const deptData = evaluationsByDept[dept];
                const statusCard = document.createElement('div');
                statusCard.className = 'stat-card';
                statusCard.style.margin = '10px';
                
                const belongingDivision = getDivisionByDept(dept);
                const excludedExecutives = belongingDivision ? 1 : 0;
                const expectedExecutives = 7 - excludedExecutives;
                
                statusCard.innerHTML = `
                    <h4 style="margin-bottom: 10px; color: #4CAF50;">${dept}</h4>
                    <p>ÏûÑÏõê ÌèâÍ∞Ä: ${deptData.executive}/${expectedExecutives}Î™Ö</p>
                    <p>ÏßÅÏõê ÌèâÍ∞Ä: ${deptData.employee}Î™Ö</p>
                    ${belongingDivision ? `<p style="font-size: 0.9em; color: #666;">‚Äª ${belongingDivision} Ï†úÏô∏</p>` : ''}
                `;
                statusDiv.appendChild(statusCard);
            });
        }

        function exportResults() {
            const deptScores = {};
            
            presentingDepts.forEach(dept => {
                deptScores[dept] = {
                    executiveScores: [],
                    employeeScores: [],
                    executiveAvg: 0,
                    employeeAvg: 0,
                    finalScore: 0
                };
            });

            Object.values(evaluations).forEach(evaluation => {
                const dept = evaluation.team;
                if (evaluation.evaluatorType === 'chairman' || evaluation.evaluatorType === 'executive') {
                    deptScores[dept].executiveScores.push(evaluation.totalScore);
                } else {
                    deptScores[dept].employeeScores.push(evaluation.totalScore);
                }
            });

            presentingDepts.forEach(dept => {
                const deptData = deptScores[dept];
                
                if (deptData.executiveScores.length > 0) {
                    deptData.executiveAvg = deptData.executiveScores.reduce((a, b) => a + b, 0) / deptData.executiveScores.length;
                }
                
                if (deptData.employeeScores.length > 0) {
                    deptData.employeeAvg = deptData.employeeScores.reduce((a, b) => a + b, 0) / deptData.employeeScores.length;
                }
                
                deptData.finalScore = (deptData.executiveAvg * 0.6) + (deptData.employeeAvg * 0.4);
            });

            const sortedDepts = presentingDepts.sort((a, b) => deptScores[b].finalScore - deptScores[a].finalScore);

            let csvContent = "ÏàúÏúÑ,Î∂ÄÏÑúÎ™Ö,ÏµúÏ¢ÖÏ†êÏàò,ÏûÑÏõêÌèâÍ∑†,ÏßÅÏõêÌèâÍ∑†,ÏûÑÏõêÌèâÍ∞ÄÏàò,ÏßÅÏõêÌèâÍ∞ÄÏàò\n";
            sortedDepts.forEach((dept, index) => {
                const deptData = deptScores[dept];
                csvContent += `${index + 1},${dept},${deptData.finalScore.toFixed(1)},${deptData.executiveAvg.toFixed(1)},${deptData.employeeAvg.toFixed(1)},${deptData.executiveScores.length},${deptData.employeeScores.length}\n`;
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '2025_ÏÑúÏãúÍ≥µÏñ¥ÏõåÎìú_ÌèâÍ∞ÄÍ≤∞Í≥º.csv';
            link.click();
        }
        function printResults() { window.print(); }
        function resetAllData() {
            if (confirm('‚ö†Ô∏è Î™®Îì† ÌèâÍ∞Ä Îç∞Ïù¥ÌÑ∞Î•º Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                evaluations = {};
                updateResults();
                alert('‚úÖ Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            initializePageMode();
            updateQRCode();
            updateResults();
            updateManagement();
            updateMonitor();
        });

        // ÏûêÎèô ÏÉàÎ°úÍ≥†Ïπ®
        setInterval(function() {
            if (document.getElementById('results').classList.contains('active')) {
                updateResults();
            } else if (document.getElementById('monitor').classList.contains('active')) {
                updateMonitor();
            }
        }, 5000);
    </script>
</body>
</html>