<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025ë…„ë„ ìƒë°˜ê¸° ì„œì‹œê³µ ì–´ì›Œë“œ ìš°ìˆ˜ê³¼ì œ í‰ê°€</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: 'ğŸ†';
            font-size: 3em;
            position: absolute;
            top: 15px;
            left: 30px;
            opacity: 0.3;
        }

        .header::after {
            content: 'â­';
            font-size: 2em;
            position: absolute;
            top: 20px;
            right: 30px;
            opacity: 0.3;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .year-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 1.1em;
            font-weight: bold;
            margin-top: 10px;
            display: inline-block;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .nav-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: #4CAF50;
            color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .nav-tab:hover:not(.active) {
            background: #e9ecef;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .evaluation-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .criteria-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .criteria-item:hover {
            border-color: #4CAF50;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .criteria-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .criteria-title {
            font-weight: 600;
            color: #333;
        }

        .criteria-max {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .score-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1.1em;
            text-align: center;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .results-table th,
        .results-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .results-table th {
            background: #4CAF50;
            color: white;
            font-weight: 600;
        }

        .results-table tr:hover {
            background: #f8f9fa;
        }

        .rank-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            color: white;
        }

        .rank-1 { background: #FFD700; color: #333; }
        .rank-2 { background: #C0C0C0; color: #333; }
        .rank-3 { background: #CD7F32; }
        .rank-other { background: #6c757d; }

        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
            background: #d4edda;
            color: #155724;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 600;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.1em;
            color: #666;
        }

        .progress-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 2px solid #f0f0f0;
        }

        .progress-number {
            font-size: 2.2em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 8px;
        }

        .progress-label {
            font-size: 1em;
            color: #666;
        }

        .monitor-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #f0f0f0;
        }

        .status-grid {
            display: grid;
            gap: 10px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .status-item.completed {
            background: #d4edda;
            border-color: #4CAF50;
            color: #155724;
        }

        .status-item.partial {
            background: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }

        .status-item.missing {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .status-item.not-applicable {
            background: #e2e3e5;
            border-color: #6c757d;
            color: #495057;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .badge-completed { background: #4CAF50; color: white; }
        .badge-partial { background: #ffc107; color: #212529; }
        .badge-missing { background: #dc3545; color: white; }
        .badge-na { background: #6c757d; color: white; }

        .team-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .team-status-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .team-status-card:hover {
            border-color: #4CAF50;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .activity-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-item:hover {
            background: #f8f9fa;
        }

        .activity-time {
            font-size: 0.85em;
            color: #666;
        }

        .blinking {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .evaluation-info-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #f0f0f0;
            transition: all 0.3s ease;
        }

        .evaluation-info-card:hover {
            border-color: #4CAF50;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .evaluation-info-card h3 {
            color: #4CAF50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .evaluation-info-card ul {
            list-style: none;
            padding: 0;
        }

        .evaluation-info-card li {
            padding: 5px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .evaluation-info-card li:last-child {
            border-bottom: none;
        }

        .qr-code-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            display: inline-block;
            margin: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .criteria-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .evaluation-info-card {
                margin-bottom: 15px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .header p {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>2025ë…„ë„ ìƒë°˜ê¸° ì„œì‹œê³µ ì–´ì›Œë“œ</h1>
            <p>ìš°ìˆ˜ê³¼ì œ í‰ê°€ ì‹œìŠ¤í…œ</p>
        </div>

        <div class="nav-tabs" id="navTabs">
            <button class="nav-tab active" onclick="showTab('welcome')" id="welcomeTab">í‰ê°€ ì•ˆë‚´</button>
            <button class="nav-tab" onclick="showTab('evaluation')" id="evaluationTab">í‰ê°€ ì…ë ¥</button>
            <button class="nav-tab" onclick="showTab('results')" id="resultsTab" style="display: none;">ì‹¤ì‹œê°„ ê²°ê³¼</button>
            <button class="nav-tab" onclick="showTab('monitor')" id="monitorTab" style="display: none;">í˜„í™© ëª¨ë‹ˆí„°ë§</button>
            <button class="nav-tab" onclick="showTab('management')" id="managementTab" style="display: none;">í‰ê°€ ê´€ë¦¬</button>
        </div>

        <!-- í‰ê°€ ì•ˆë‚´ íƒ­ -->
        <div id="welcome" class="tab-content active">
            <div style="text-align: center; padding: 40px 20px;">
                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px; padding: 40px; margin-bottom: 30px;">
                    <h2 style="color: #4CAF50; margin-bottom: 20px; font-size: 2em;">ğŸ† 2025ë…„ë„ ìƒë°˜ê¸° ì„œì‹œê³µ ì–´ì›Œë“œ í‰ê°€ì— ì°¸ì—¬í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!</h2>
                    <p style="font-size: 1.2em; color: #666; line-height: 1.6;">
                        ì•„ë˜ ë‚´ìš©ì„ í™•ì¸ í›„ ì´ 8ê°œ ìš°ìˆ˜ê³¼ì œ ë°œí‘œíŒ€ì˜ ì„±ê³¼ë¥¼ ê³µì •í•˜ê²Œ í‰ê°€í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.
                    </p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="evaluation-info-card">
                        <h3>ğŸ“‹ í‰ê°€ í•­ëª©</h3>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li><strong>ì°½ì˜ì„±</strong>: 18~30ì </li>
                            <li><strong>ë‚œì´ë„</strong>: 18~30ì </li>
                            <li><strong>íš¨ê³¼ì„±</strong>: 12~20ì </li>
                            <li><strong>ì „íŒŒì„±</strong>: 6~10ì </li>
                            <li><strong>ê¸°ì—¬ë„</strong>: 6~10ì </li>
                        </ul>
                        <p style="color: #4CAF50; font-weight: bold;">ì´ 60~100ì </p>
                    </div>

                    <div class="evaluation-info-card">
                        <h3>ğŸ¯ ìš°ìˆ˜ê³¼ì œ ë°œí‘œ ë¶€ì„œ</h3>
                        <ul style="text-align: left; margin: 15px 0; font-size: 0.95em;">
                            <li>ITì „ëµì‹¤</li>
                            <li>ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜</li>
                            <li>ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›</li>
                            <li>ì²­ê³„ì²œê´€ë¦¬ì²˜</li>
                            <li>ìì‚°ê´€ë¦¬í˜ì‹ ì²˜</li>
                            <li>ê³µì‚¬ê°ë…1ì²˜</li>
                            <li>ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜</li>
                            <li>ê³µê³µìì „ê±°ìš´ì˜ì²˜</li>
                        </ul>
                    </div>

                    <div class="evaluation-info-card">
                        <h3>âš ï¸ í‰ê°€ ì œí•œì‚¬í•­</h3>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li><strong>ì§ì›</strong>: ë³¸ì¸ ì†Œì†ë¶€ì„œ í‰ê°€ ë¶ˆê°€</li>
                            <li><strong>ë³¸ë¶€ì¥</strong>: ë‹´ë‹¹ ë³¸ë¶€ ë°œí‘œíŒ€ í‰ê°€ ë¶ˆê°€</li>
                            <li><strong>ì´ì‚¬ì¥</strong>: ëª¨ë“  íŒ€ í‰ê°€ ê°€ëŠ¥</li>
                        </ul>
                        <p style="color: #dc3545; font-weight: bold; font-size: 0.9em;">
                            â€» ê³µì •í•œ í‰ê°€ë¥¼ ìœ„í•´ ìë™ìœ¼ë¡œ ì œí•œë©ë‹ˆë‹¤
                        </p>
                    </div>
                </div>

                <div style="background: white; border: 2px solid #4CAF50; border-radius: 15px; padding: 30px; margin: 20px 0; text-align: center;">
                    <h4 style="color: #4CAF50; margin-bottom: 20px; font-size: 1.3em;">ğŸ“± ëª¨ë°”ì¼/íƒœë¸”ë¦¿ ì ‘ì†</h4>
                    
                    <div style="display: flex; justify-content: center; align-items: center; gap: 30px; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin-bottom: 15px;">
                                <img src="" 
                                     alt="QR Code" 
                                     style="width: 200px; height: 200px; border-radius: 8px;"
                                     id="mainQRCode">
                            </div>
                            <p style="font-weight: bold; color: #4CAF50; margin-bottom: 5px;">QRì½”ë“œë¡œ ë°”ë¡œ ì ‘ì†</p>
                            <p style="font-size: 0.9em; color: #666;">ìŠ¤ë§ˆíŠ¸í° ì¹´ë©”ë¼ë¡œ ìŠ¤ìº”í•˜ì„¸ìš”</p>
                        </div>
                        
                        <div style="text-align: left; max-width: 350px;">
                            <h5 style="color: #4CAF50; margin-bottom: 15px;">ğŸ”— ì§ì ‘ ì ‘ì† ì£¼ì†Œ</h5>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #dee2e6;">
                                <div style="font-family: 'Courier New', monospace; font-size: 0.9em; word-break: break-all;" id="currentURL">
                                    
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                                <button class="btn btn-secondary" onclick="copyMainLink()" style="font-size: 0.9em;">ğŸ“‹ ë³µì‚¬</button>
                                <button class="btn btn-secondary" onclick="shareMainLink()" style="font-size: 0.9em;">ğŸ“¤ ê³µìœ </button>
                            </div>

                            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; border: 1px solid #ffc107; margin-top: 15px;">
                                <p style="font-size: 0.85em; color: #856404; margin: 0;"><strong>ğŸ“‹ ê´€ë¦¬ììš© ì ‘ì†:</strong></p>
                                <p style="font-size: 0.8em; color: #856404; margin: 5px 0 0 0;">URL ë’¤ì— <code>?admin=true</code> ì¶”ê°€</p>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" style="font-size: 1.3em; padding: 15px 40px; margin-top: 20px;" onclick="showTab('evaluation')">
                    í‰ê°€ ì‹œì‘í•˜ê¸° â†’
                </button>
            </div>
        </div>

        <!-- í‰ê°€ ì…ë ¥ íƒ­ -->
        <div id="evaluation" class="tab-content">
            <div class="evaluation-form">
                <h2 style="margin-bottom: 20px; color: #333;">í‰ê°€ ì •ë³´ ì…ë ¥</h2>
                
                <div class="form-group">
                    <label for="evaluatorType">í‰ê°€ì êµ¬ë¶„</label>
                    <select id="evaluatorType" onchange="updateEvaluatorOptions()">
                        <option value="">í‰ê°€ì êµ¬ë¶„ ì„ íƒ</option>
                        <option value="chairman">ì´ì‚¬ì¥</option>
                        <option value="executive">ë³¸ë¶€ì¥</option>
                        <option value="employee">ì§ì›</option>
                    </select>
                </div>

                <div class="form-group" id="executiveGroup" style="display: none;">
                    <label for="executivePosition">ì†Œì†ë³¸ë¶€</label>
                    <select id="executivePosition">
                        <option value="">ì†Œì†ë³¸ë¶€ ì„ íƒ</option>
                        <option value="ê²½ì˜ì „ëµë³¸ë¶€ì¥">ê²½ì˜ì „ëµ</option>
                        <option value="ë³µì§€ê²½ì œë³¸ë¶€ì¥">ë³µì§€ê²½ì œ</option>
                        <option value="ë¬¸í™”ì²´ìœ¡ë³¸ë¶€ì¥">ë¬¸í™”ì²´ìœ¡</option>
                        <option value="ë„ë¡œê´€ë¦¬ë³¸ë¶€ì¥">ë„ë¡œê´€ë¦¬</option>
                        <option value="ì‹œì„¤ì•ˆì „ë³¸ë¶€ì¥">ì‹œì„¤ì•ˆì „</option>
                        <option value="êµí†µì‚¬ì—…ë³¸ë¶€ì¥">êµí†µì‚¬ì—…</option>
                    </select>
                </div>

                <div class="form-group" id="evaluatorNameGroup">
                    <label for="evaluatorName">í‰ê°€ìëª…</label>
                    <input type="text" id="evaluatorName" placeholder="í‰ê°€ì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>

                <div class="form-group" id="departmentGroup" style="display: none;">
                    <label for="evaluatorDept">ì†Œì† ë¶€ì„œ</label>
                    <select id="evaluatorDept">
                        <option value="">ë¶€ì„œ ì„ íƒ</option>
                        <option value="ê°ì‚¬ì‹¤">ê°ì‚¬ì‹¤</option>
                        <option value="ê¸°íšì¡°ì •ì‹¤">ê¸°íšì¡°ì •ì‹¤</option>
                        <option value="ì¸ì‚¬ë…¸ë¬´ì²˜">ì¸ì‚¬ë…¸ë¬´ì²˜</option>
                        <option value="ì´ë¬´ì²˜">ì´ë¬´ì²˜</option>
                        <option value="í™ë³´ì‹¤">í™ë³´ì‹¤</option>
                        <option value="ì¸ì¬ë¬¸í™”ì›">ì¸ì¬ë¬¸í™”ì›</option>
                        <option value="ITì „ëµì‹¤">ITì „ëµì‹¤</option>
                        <option value="ì•ˆì „ì²˜">ì•ˆì „ì²˜</option>
                        <option value="ìƒê°€ìš´ì˜ì²˜">ìƒê°€ìš´ì˜ì²˜</option>
                        <option value="ì¶”ëª¨ì‹œì„¤ìš´ì˜ì²˜">ì¶”ëª¨ì‹œì„¤ìš´ì˜ì²˜</option>
                        <option value="ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜">ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜</option>
                        <option value="ì„œìš¸ì›”ë“œì»µê²½ê¸°ì¥ìš´ì˜ì²˜">ì„œìš¸ì›”ë“œì»µê²½ê¸°ì¥ìš´ì˜ì²˜</option>
                        <option value="ë”ê²½ê¸°ì¥ìš´ì˜ì²˜">ë”ê²½ê¸°ì¥ìš´ì˜ì²˜</option>
                        <option value="ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›">ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›</option>
                        <option value="ì²­ê³„ì²œê´€ë¦¬ì²˜">ì²­ê³„ì²œê´€ë¦¬ì²˜</option>
                        <option value="ë‚¨ì‚°ê³¤ëŒë¼ì¸ìˆ˜ë‹¨TF">ë‚¨ì‚°ê³¤ëŒë¼ì¸ìˆ˜ë‹¨TF</option>
                        <option value="ìì‚°ê´€ë¦¬í˜ì‹ ì²˜">ìì‚°ê´€ë¦¬í˜ì‹ ì²˜</option>
                        <option value="ë„ë¡œê´€ë¦¬ì²˜">ë„ë¡œê´€ë¦¬ì²˜</option>
                        <option value="ë„ë¡œì‹œì„¤ì²˜">ë„ë¡œì‹œì„¤ì²˜</option>
                        <option value="ë„ë¡œê¸°ì „ì²˜">ë„ë¡œê¸°ì „ì²˜</option>
                        <option value="ë„ë¡œí™˜ê²½ì²˜">ë„ë¡œí™˜ê²½ì²˜</option>
                        <option value="êµí†µì •ë³´ì²˜">êµí†µì •ë³´ì²˜</option>
                        <option value="ê³µì‚¬ê°ë…1ì²˜">ê³µì‚¬ê°ë…1ì²˜</option>
                        <option value="ê³µì‚¬ê°ë…2ì²˜">ê³µì‚¬ê°ë…2ì²˜</option>
                        <option value="ê³µì‚¬ê°ë…3ì²˜">ê³µì‚¬ê°ë…3ì²˜</option>
                        <option value="ê³µë™êµ¬ê´€ë¦¬ì²˜">ê³µë™êµ¬ê´€ë¦¬ì²˜</option>
                        <option value="ìƒìˆ˜ë„ì§€ì›ì²˜">ìƒìˆ˜ë„ì§€ì›ì²˜</option>
                        <option value="ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜">ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜</option>
                        <option value="êµí†µì‹œì„¤ìš´ì˜ì²˜">êµí†µì‹œì„¤ìš´ì˜ì²˜</option>
                        <option value="ê³µê³µìì „ê±°ìš´ì˜ì²˜">ê³µê³µìì „ê±°ìš´ì˜ì²˜</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="teamSelect">í‰ê°€ëŒ€ìƒ ìš°ìˆ˜ê³¼ì œ</label>
                    <select id="teamSelect">
                        <option value="">í‰ê°€í•  ìš°ìˆ˜ê³¼ì œ ì„ íƒ</option>
                        <option value="ITì „ëµì‹¤">ITì „ëµì‹¤</option>
                        <option value="ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜">ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜</option>
                        <option value="ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›">ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›</option>
                        <option value="ì²­ê³„ì²œê´€ë¦¬ì²˜">ì²­ê³„ì²œê´€ë¦¬ì²˜</option>
                        <option value="ìì‚°ê´€ë¦¬í˜ì‹ ì²˜">ìì‚°ê´€ë¦¬í˜ì‹ ì²˜</option>
                        <option value="ê³µì‚¬ê°ë…1ì²˜">ê³µì‚¬ê°ë…1ì²˜</option>
                        <option value="ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜">ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜</option>
                        <option value="ê³µê³µìì „ê±°ìš´ì˜ì²˜">ê³µê³µìì „ê±°ìš´ì˜ì²˜</option>
                    </select>
                </div>

                <div class="criteria-grid">
                    <div class="criteria-item">
                        <div class="criteria-header">
                            <span class="criteria-title">ì°½ì˜ì„±</span>
                            <span class="criteria-max">18~30ì </span>
                        </div>
                        <input type="number" class="score-input" id="creativity" min="18" max="30" placeholder="18-30ì ">
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ìµœì†Œ 18ì  ~ ìµœëŒ€ 30ì </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-header">
                            <span class="criteria-title">ë‚œì´ë„</span>
                            <span class="criteria-max">18~30ì </span>
                        </div>
                        <input type="number" class="score-input" id="difficulty" min="18" max="30" placeholder="18-30ì ">
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ìµœì†Œ 18ì  ~ ìµœëŒ€ 30ì </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-header">
                            <span class="criteria-title">íš¨ê³¼ì„±</span>
                            <span class="criteria-max">12~20ì </span>
                        </div>
                        <input type="number" class="score-input" id="effectiveness" min="12" max="20" placeholder="12-20ì ">
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ìµœì†Œ 12ì  ~ ìµœëŒ€ 20ì </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-header">
                            <span class="criteria-title">ì „íŒŒì„±</span>
                            <span class="criteria-max">6~10ì </span>
                        </div>
                        <input type="number" class="score-input" id="propagation" min="6" max="10" placeholder="6-10ì ">
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ìµœì†Œ 6ì  ~ ìµœëŒ€ 10ì </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-header">
                            <span class="criteria-title">ê¸°ì—¬ë„</span>
                            <span class="criteria-max">6~10ì </span>
                        </div>
                        <input type="number" class="score-input" id="contribution" min="6" max="10" placeholder="6-10ì ">
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ìµœì†Œ 6ì  ~ ìµœëŒ€ 10ì </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="submitEvaluation()">í‰ê°€ ì œì¶œ</button>
                    <button class="btn btn-secondary" onclick="resetForm()">ì´ˆê¸°í™”</button>
                </div>
            </div>
        </div>

        <!-- ì‹¤ì‹œê°„ ê²°ê³¼ íƒ­ -->
        <div id="results" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalEvaluations">0</div>
                    <div class="stat-label">ì´ í‰ê°€ ìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="executiveEvaluations">0</div>
                    <div class="stat-label">ì„ì› í‰ê°€</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="employeeEvaluations">0</div>
                    <div class="stat-label">ì§ì› í‰ê°€</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completionRate">0%</div>
                    <div class="stat-label">ì™„ë£Œìœ¨</div>
                </div>
            </div>

            <h2 style="margin-bottom: 20px; color: #333;">ğŸ† 2025ë…„ë„ ìƒë°˜ê¸° ì„œì‹œê³µ ì–´ì›Œë“œ ì‹¤ì‹œê°„ ìˆœìœ„</h2>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>ìˆœìœ„</th>
                        <th>ë¶€ì„œëª…</th>
                        <th>ìµœì¢… ì ìˆ˜</th>
                        <th>ì„ì› ì ìˆ˜</th>
                        <th>ì§ì› ì ìˆ˜</th>
                        <th>ì´ í‰ê°€ì</th>
                    </tr>
                </thead>
                <tbody id="resultsTableBody">
                    <!-- ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </tbody>
            </table>
        </div>

        <!-- í˜„í™© ëª¨ë‹ˆí„°ë§ íƒ­ -->
        <div id="monitor" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: #333; margin: 0;">ğŸ“Š ì‹¤ì‹œê°„ í‰ê°€ í˜„í™© ëª¨ë‹ˆí„°ë§</h2>
                <div>
                    <button class="btn btn-primary" onclick="updateMonitor()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                    <button class="btn btn-secondary" onclick="exportMissingList()">ğŸ“‹ ë¯¸ì™„ë£Œì ëª…ë‹¨ ì¶œë ¥</button>
                </div>
            </div>

            <!-- ì „ì²´ ì§„í–‰ë¥  -->
            <div class="progress-overview" style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                <h3 style="margin-bottom: 20px; color: #4CAF50;">ğŸ“ˆ ì „ì²´ ì§„í–‰ í˜„í™©</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div class="progress-card">
                        <div class="progress-number" id="overallProgress">0%</div>
                        <div class="progress-label">ì „ì²´ ì™„ë£Œìœ¨</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="executiveProgress">0%</div>
                        <div class="progress-label">ì„ì› ì™„ë£Œìœ¨</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="employeeProgress">0%</div>
                        <div class="progress-label">ì§ì› ì™„ë£Œìœ¨</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="lastUpdate">-</div>
                        <div class="progress-label">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</div>
                    </div>
                </div>
            </div>

            <!-- ë¶€ì„œë³„ í‰ê°€ í˜„í™© -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <!-- ì„ì› í‰ê°€ í˜„í™© -->
                <div class="monitor-section">
                    <h3 style="color: #4CAF50; margin-bottom: 15px;">ğŸ‘” ì„ì› í‰ê°€ í˜„í™©</h3>
                    <div id="executiveStatus" class="status-grid">
                        <!-- ì„ì›ë³„ í‰ê°€ í˜„í™©ì´ ì—¬ê¸°ì— í‘œì‹œ -->
                    </div>
                </div>

                <!-- ì§ì› í‰ê°€ í˜„í™© (ë¶€ì„œë³„) -->
                <div class="monitor-section">
                    <h3 style="color: #4CAF50; margin-bottom: 15px;">ğŸ‘¥ ì§ì› í‰ê°€ í˜„í™© (ë¶€ì„œë³„)</h3>
                    <div id="departmentStatus" class="status-grid">
                        <!-- ë¶€ì„œë³„ í‰ê°€ í˜„í™©ì´ ì—¬ê¸°ì— í‘œì‹œ -->
                    </div>
                </div>
            </div>

            <!-- ë°œí‘œíŒ€ë³„ í‰ê°€ ì™„ë£Œ í˜„í™© -->
            <div class="monitor-section">
                <h3 style="color: #4CAF50; margin-bottom: 15px;">ğŸ¯ ë°œí‘œíŒ€ë³„ í‰ê°€ ì™„ë£Œ í˜„í™©</h3>
                <div class="team-status-grid" id="teamStatusGrid">
                    <!-- ë°œí‘œíŒ€ë³„ í˜„í™©ì´ ì—¬ê¸°ì— í‘œì‹œ -->
                </div>
            </div>

            <!-- ìµœê·¼ í‰ê°€ í™œë™ ë¡œê·¸ -->
            <div class="monitor-section" style="margin-top: 30px;">
                <h3 style="color: #4CAF50; margin-bottom: 15px;">ğŸ“ ìµœê·¼ í‰ê°€ í™œë™ (ì‹¤ì‹œê°„)</h3>
                <div id="recentActivity" style="background: white; border-radius: 10px; max-height: 300px; overflow-y: auto;">
                    <!-- ìµœê·¼ í™œë™ì´ ì—¬ê¸°ì— í‘œì‹œ -->
                </div>
            </div>
        </div>

        <!-- í‰ê°€ ê´€ë¦¬ íƒ­ -->
        <div id="management" class="tab-content">
            <h2 style="margin-bottom: 20px; color: #333;">í‰ê°€ ê´€ë¦¬</h2>
            
            <div style="margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="exportResults()">ê²°ê³¼ ë‚´ë³´ë‚´ê¸°</button>
                <button class="btn btn-secondary" onclick="printResults()">ê²°ê³¼ ì¸ì‡„</button>
                <button class="btn btn-danger" onclick="resetAllData()">ì „ì²´ ì´ˆê¸°í™”</button>
            </div>

            <h3 style="margin-bottom: 15px; color: #333;">í‰ê°€ í˜„í™©</h3>
            <div id="evaluationStatus"></div>
        </div>
    </div>

    <script>
        // í˜ì´ì§€ ëª¨ë“œ í™•ì¸ (ê´€ë¦¬ììš© vs í‰ê°€ë‹¨ìš©)
        const urlParams = new URLSearchParams(window.location.search);
        const isAdminMode = urlParams.get('admin') === 'true';

        // ë°ì´í„° ì €ì¥ì†Œ
        let evaluations = {};
        let presentingDepts = ['ITì „ëµì‹¤', 'ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜', 'ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›', 'ì²­ê³„ì²œê´€ë¦¬ì²˜', 'ìì‚°ê´€ë¦¬í˜ì‹ ì²˜', 'ê³µì‚¬ê°ë…1ì²˜', 'ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜', 'ê³µê³µìì „ê±°ìš´ì˜ì²˜'];
        
        // ì „ì²´ ë¶€ì„œ ëª©ë¡
        let allDepartments = [
            'ê°ì‚¬ì‹¤', 'ê¸°íšì¡°ì •ì‹¤', 'ì¸ì‚¬ë…¸ë¬´ì²˜', 'ì´ë¬´ì²˜', 'í™ë³´ì‹¤', 'ì¸ì¬ë¬¸í™”ì›', 'ITì „ëµì‹¤', 'ì•ˆì „ì²˜',
            'ìƒê°€ìš´ì˜ì²˜', 'ì¶”ëª¨ì‹œì„¤ìš´ì˜ì²˜', 'ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜',
            'ì„œìš¸ì›”ë“œì»µê²½ê¸°ì¥ìš´ì˜ì²˜', 'ë”ê²½ê¸°ì¥ìš´ì˜ì²˜', 'ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›', 'ì²­ê³„ì²œê´€ë¦¬ì²˜', 'ë‚¨ì‚°ê³¤ëŒë¼ì¸ìˆ˜ë‹¨TF',
            'ìì‚°ê´€ë¦¬í˜ì‹ ì²˜', 'ë„ë¡œê´€ë¦¬ì²˜', 'ë„ë¡œì‹œì„¤ì²˜', 'ë„ë¡œê¸°ì „ì²˜', 'ë„ë¡œí™˜ê²½ì²˜', 'êµí†µì •ë³´ì²˜',
            'ê³µì‚¬ê°ë…1ì²˜', 'ê³µì‚¬ê°ë…2ì²˜', 'ê³µì‚¬ê°ë…3ì²˜', 'ê³µë™êµ¬ê´€ë¦¬ì²˜', 'ìƒìˆ˜ë„ì§€ì›ì²˜',
            'ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜', 'êµí†µì‹œì„¤ìš´ì˜ì²˜', 'ê³µê³µìì „ê±°ìš´ì˜ì²˜'
        ];
        
        // ì„ì› ëª©ë¡
        let executives = ['ì´ì‚¬ì¥', 'ê²½ì˜ì „ëµë³¸ë¶€ì¥', 'ë³µì§€ê²½ì œë³¸ë¶€ì¥', 'ë¬¸í™”ì²´ìœ¡ë³¸ë¶€ì¥', 'ë„ë¡œê´€ë¦¬ë³¸ë¶€ì¥', 'ì‹œì„¤ì•ˆì „ë³¸ë¶€ì¥', 'êµí†µì‚¬ì—…ë³¸ë¶€ì¥'];
        
        // ë³¸ë¶€ë³„ ì†Œì† ë¶€ì„œ ë§¤í•‘
        let divisionMapping = {
            'ê²½ì˜ì „ëµë³¸ë¶€ì¥': ['ê°ì‚¬ì‹¤', 'ê¸°íšì¡°ì •ì‹¤', 'ì¸ì‚¬ë…¸ë¬´ì²˜', 'ì´ë¬´ì²˜', 'í™ë³´ì‹¤', 'ì¸ì¬ë¬¸í™”ì›', 'ITì „ëµì‹¤', 'ì•ˆì „ì²˜'],
            'ë³µì§€ê²½ì œë³¸ë¶€ì¥': ['ìƒê°€ìš´ì˜ì²˜', 'ì¶”ëª¨ì‹œì„¤ìš´ì˜ì²˜', 'ì¥ì• ì¸ì½œíƒì‹œìš´ì˜ì²˜'],
            'ë¬¸í™”ì²´ìœ¡ë³¸ë¶€ì¥': ['ì„œìš¸ì›”ë“œì»µê²½ê¸°ì¥ìš´ì˜ì²˜', 'ë”ê²½ê¸°ì¥ìš´ì˜ì²˜', 'ì„œìš¸ì–´ë¦°ì´ëŒ€ê³µì›', 'ì²­ê³„ì²œê´€ë¦¬ì²˜', 'ë‚¨ì‚°ê³¤ëŒë¼ì¸ìˆ˜ë‹¨TF'],
            'ë„ë¡œê´€ë¦¬ë³¸ë¶€ì¥': ['ìì‚°ê´€ë¦¬í˜ì‹ ì²˜', 'ë„ë¡œê´€ë¦¬ì²˜', 'ë„ë¡œì‹œì„¤ì²˜', 'ë„ë¡œê¸°ì „ì²˜', 'ë„ë¡œí™˜ê²½ì²˜', 'êµí†µì •ë³´ì²˜'],
            'ì‹œì„¤ì•ˆì „ë³¸ë¶€ì¥': ['ê³µì‚¬ê°ë…1ì²˜', 'ê³µì‚¬ê°ë…2ì²˜', 'ê³µì‚¬ê°ë…3ì²˜', 'ê³µë™êµ¬ê´€ë¦¬ì²˜', 'ìƒìˆ˜ë„ì§€ì›ì²˜'],
            'êµí†µì‚¬ì—…ë³¸ë¶€ì¥': ['ì£¼ì°¨ì‹œì„¤ìš´ì˜ì²˜', 'êµí†µì‹œì„¤ìš´ì˜ì²˜', 'ê³µê³µìì „ê±°ìš´ì˜ì²˜']
        };

        // ê° ë°œí‘œíŒ€ì´ ì†í•œ ë³¸ë¶€ ì°¾ê¸°
        function getDivisionByDept(dept) {
            for (let division in divisionMapping) {
                if (divisionMapping[division].includes(dept)) {
                    return division;
                }
            }
            return null;
        }

        // í‰ê°€ì êµ¬ë¶„ì— ë”°ë¥¸ ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateEvaluatorOptions() {
            const evaluatorType = document.getElementById('evaluatorType').value;
            const departmentGroup = document.getElementById('departmentGroup');
            const executiveGroup = document.getElementById('executiveGroup');
            const evaluatorNameGroup = document.getElementById('evaluatorNameGroup');
            const evaluatorNameInput = document.getElementById('evaluatorName');
            
            // ëª¨ë“  ê·¸ë£¹ ìˆ¨ê¸°ê¸°
            departmentGroup.style.display = 'none';
            executiveGroup.style.display = 'none';
            
            // í‰ê°€ìëª… í•„ë“œ ì²˜ë¦¬
            if (evaluatorType === 'chairman' || evaluatorType === 'executive') {
                evaluatorNameGroup.style.display = 'none';
                evaluatorNameInput.value = evaluatorType === 'chairman' ? 'ì´ì‚¬ì¥' : '';
            } else {
                evaluatorNameGroup.style.display = 'block';
                evaluatorNameInput.value = '';
            }
            
            if (evaluatorType === 'employee') {
                departmentGroup.style.display = 'block';
                document.getElementById('evaluatorDept').addEventListener('change', updateAvailableTeams);
            } else if (evaluatorType === 'executive') {
                executiveGroup.style.display = 'block';
                document.getElementById('executivePosition').addEventListener('change', function() {
                    // ë³¸ë¶€ì¥ ì„ íƒ ì‹œ í‰ê°€ìëª… ìë™ ì„¤ì •
                    const selectedPosition = this.value;
                    if (selectedPosition) {
                        evaluatorNameInput.value = selectedPosition;
                    }
                    updateAvailableTeams();
                });
            }
            
            updateAvailableTeams();
        }

        // ì‚¬ìš© ê°€ëŠ¥í•œ ë°œí‘œíŒ€ ì—…ë°ì´íŠ¸
        function updateAvailableTeams() {
            const evaluatorType = document.getElementById('evaluatorType').value;
            const evaluatorDept = document.getElementById('evaluatorDept').value;
            const executivePosition = document.getElementById('executivePosition').value;
            const teamSelect = document.getElementById('teamSelect');
            
            teamSelect.innerHTML = '<option value="">í‰ê°€í•  ìš°ìˆ˜ê³¼ì œ ì„ íƒ</option>';
            
            presentingDepts.forEach(dept => {
                let canEvaluate = true;
                
                if (evaluatorType === 'chairman') {
                    canEvaluate = true;
                } else if (evaluatorType === 'executive') {
                    const deptDivision = getDivisionByDept(dept);
                    canEvaluate = executivePosition !== deptDivision;
                } else if (evaluatorType === 'employee') {
                    canEvaluate = evaluatorDept !== dept;
                }
                
                if (canEvaluate) {
                    const option = document.createElement('option');
                    option.value = dept;
                    option.textContent = dept;
                    teamSelect.appendChild(option);
                }
            });
            
            // ì œì™¸ëœ íŒ€ì— ëŒ€í•œ ì•ˆë‚´ ë©”ì‹œì§€
            if (evaluatorType === 'employee' && evaluatorDept && presentingDepts.includes(evaluatorDept)) {
                const excludedMsg = document.createElement('option');
                excludedMsg.disabled = true;
                excludedMsg.textContent = `â€» ${evaluatorDept}ì€(ëŠ”) í‰ê°€ ëŒ€ìƒì—ì„œ ì œì™¸ë©ë‹ˆë‹¤`;
                excludedMsg.style.color = '#999';
                excludedMsg.style.fontStyle = 'italic';
                teamSelect.appendChild(excludedMsg);
            } else if (evaluatorType === 'executive' && executivePosition) {
                const excludedDepts = divisionMapping[executivePosition].filter(dept => presentingDepts.includes(dept));
                if (excludedDepts.length > 0) {
                    const excludedMsg = document.createElement('option');
                    excludedMsg.disabled = true;
                    excludedMsg.textContent = `â€» ${excludedDepts.join(', ')}ì€(ëŠ”) í‰ê°€ ëŒ€ìƒì—ì„œ ì œì™¸ë©ë‹ˆë‹¤`;
                    excludedMsg.style.color = '#999';
                    excludedMsg.style.fontStyle = 'italic';
                    teamSelect.appendChild(excludedMsg);
                }
            }
        }

        // íƒ­ ì „í™˜
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'results') {
                updateResults();
            } else if (tabName === 'management') {
                updateManagement();
            } else if (tabName === 'monitor') {
                updateMonitor();
            }
        }

        // QRì½”ë“œ ë° URL ì—…ë°ì´íŠ¸
        function updateQRCode() {
            const currentURL = window.location.href.split('?')[0]; // íŒŒë¼ë¯¸í„° ì œê±°í•œ ê¸°ë³¸ URL
            const qrImg = document.getElementById('mainQRCode');
            const urlDiv = document.getElementById('currentURL');
            
            if (qrImg) {
                qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(currentURL)}`;
            }
            if (urlDiv) {
                urlDiv.textContent = currentURL;
            }
        }

        // ë§í¬ ë³µì‚¬ (ê¸°ë³¸ URLë¡œ)
        function copyMainLink() {
            const url = window.location.href.split('?')[0];
            navigator.clipboard.writeText(url).then(() => {
                alert('ğŸ“‹ ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n' + url);
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('ğŸ“‹ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n' + url);
            });
        }

        // ê³µìœ í•˜ê¸° (ê¸°ë³¸ URLë¡œ)
        function shareMainLink() {
            const url = window.location.href.split('?')[0];
            const title = '2025ë…„ë„ ìƒë°˜ê¸° ì„œì‹œê³µ ì–´ì›Œë“œ ìš°ìˆ˜ê³¼ì œ í‰ê°€';
            const description = 'ìš°ìˆ˜ê³¼ì œ ë°œí‘œ í‰ê°€ì— ì°¸ì—¬í•´ì£¼ì„¸ìš”!';
            
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: description,
                    url: url
                });
            } else {
                copyMainLink();
            }
        }

        // í˜ì´ì§€ ëª¨ë“œì— ë”°ë¥¸ íƒ­ í‘œì‹œ/ìˆ¨ê¹€
        function initializePageMode() {
            if (isAdminMode) {
                // ê´€ë¦¬ì ëª¨ë“œ: ëª¨ë“  íƒ­ í‘œì‹œ
                document.getElementById('resultsTab').style.display = 'block';
                document.getElementById('monitorTab').style.display = 'block';
                document.getElementById('managementTab').style.display = 'block';
                
                // í—¤ë”ì— ê´€ë¦¬ì í‘œì‹œ ì¶”ê°€
                const header = document.querySelector('.header h1');
                header.innerHTML = '2025ë…„ë„ ìƒë°˜ê¸° ì„œì‹œê³µ ì–´ì›Œë“œ <span style="background: #ff4444; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.6em; margin-left: 10px;">ê´€ë¦¬ì</span>';
            } else {
                // í‰ê°€ë‹¨ ëª¨ë“œ: í‰ê°€ ì•ˆë‚´ì™€ í‰ê°€ ì…ë ¥ íƒ­ë§Œ í‘œì‹œ
                document.getElementById('resultsTab').style.display = 'none';
                document.getElementById('monitorTab').style.display = 'none';
                document.getElementById('managementTab').style.display = 'none';
            }
        }

        // í‰ê°€ ì œì¶œ
        function submitEvaluation() {
            const evaluatorType = document.getElementById('evaluatorType').value;
            const evaluatorName = document.getElementById('evaluatorName').value;
            const evaluatorDept = document.getElementById('evaluatorDept').value;
            const executivePosition = document.getElementById('executivePosition').value;
            const teamSelect = document.getElementById('teamSelect').value;
            
            const creativity = parseInt(document.getElementById('creativity').value) || 0;
            const difficulty = parseInt(document.getElementById('difficulty').value) || 0;
            const effectiveness = parseInt(document.getElementById('effectiveness').value) || 0;
            const propagation = parseInt(document.getElementById('propagation').value) || 0;
            const contribution = parseInt(document.getElementById('contribution').value) || 0;

            // ì…ë ¥ ê²€ì¦
            if (!evaluatorType || !teamSelect) {
                alert('í‰ê°€ì ì •ë³´ì™€ í‰ê°€ëŒ€ìƒ ìš°ìˆ˜ê³¼ì œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (evaluatorType === 'employee' && (!evaluatorDept || !evaluatorName)) {
                alert('ì§ì› í‰ê°€ìëŠ” ì†Œì† ë¶€ì„œì™€ í‰ê°€ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (evaluatorType === 'executive' && !executivePosition) {
                alert('ë³¸ë¶€ì¥ì€ ì†Œì†ë³¸ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì ìˆ˜ ë²”ìœ„ ê²€ì¦
            if (creativity < 18 || creativity > 30) {
                alert('ì°½ì˜ì„± ì ìˆ˜ëŠ” 18ì ~30ì  ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            if (difficulty < 18 || difficulty > 30) {
                alert('ë‚œì´ë„ ì ìˆ˜ëŠ” 18ì ~30ì  ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            if (effectiveness < 12 || effectiveness > 20) {
                alert('íš¨ê³¼ì„± ì ìˆ˜ëŠ” 12ì ~20ì  ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            if (propagation < 6 || propagation > 10) {
                alert('ì „íŒŒì„± ì ìˆ˜ëŠ” 6ì ~10ì  ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            if (contribution < 6 || contribution > 10) {
                alert('ê¸°ì—¬ë„ ì ìˆ˜ëŠ” 6ì ~10ì  ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            // ì œí•œì‚¬í•­ ê²€ì¦
            if (evaluatorType === 'employee' && evaluatorDept === teamSelect) {
                alert('ë³¸ì¸ì´ ì†Œì†ëœ ë¶€ì„œëŠ” í‰ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            if (evaluatorType === 'executive') {
                const deptDivision = getDivisionByDept(teamSelect);
                if (executivePosition === deptDivision) {
                    alert('ë³¸ì¸ì´ ë‹´ë‹¹í•˜ëŠ” ë³¸ë¶€ì˜ ë°œí‘œíŒ€ì€ í‰ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
            }

            const totalScore = creativity + difficulty + effectiveness + propagation + contribution;
            
            // í‰ê°€ ë°ì´í„° ì €ì¥
            const evaluationId = `${evaluatorType}_${evaluatorName}_${teamSelect}_${Date.now()}`;
            evaluations[evaluationId] = {
                evaluatorType,
                evaluatorName,
                evaluatorDept,
                executivePosition,
                team: teamSelect,
                scores: {
                    creativity,
                    difficulty,
                    effectiveness,
                    propagation,
                    contribution
                },
                totalScore,
                timestamp: new Date().toISOString()
            };

            alert(`ğŸ‰ ${teamSelect} ë°œí‘œì— ëŒ€í•œ í‰ê°€ê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ì : ${totalScore}ì \n\nê°ì‚¬í•©ë‹ˆë‹¤!`);
            resetForm();
        }

        // í¼ ì´ˆê¸°í™”
        function resetForm() {
            document.getElementById('evaluatorType').value = '';
            document.getElementById('evaluatorName').value = '';
            document.getElementById('evaluatorDept').value = '';
            document.getElementById('executivePosition').value = '';
            document.getElementById('teamSelect').value = '';
            document.getElementById('creativity').value = '';
            document.getElementById('difficulty').value = '';
            document.getElementById('effectiveness').value = '';
            document.getElementById('propagation').value = '';
            document.getElementById('contribution').value = '';
            document.getElementById('departmentGroup').style.display = 'none';
            document.getElementById('executiveGroup').style.display = 'none';
            document.getElementById('evaluatorNameGroup').style.display = 'block';
        }

        // ê²°ê³¼ ì—…ë°ì´íŠ¸
        function updateResults() {
            const deptScores = {};
            
            // ë°œí‘œ ë¶€ì„œë³„ ì ìˆ˜ ì´ˆê¸°í™”
            presentingDepts.forEach(dept => {
                deptScores[dept] = {
                    executiveScores: [],
                    employeeScores: [],
                    executiveAvg: 0,
                    employeeAvg: 0,
                    finalScore: 0
                };
            });

            // í‰ê°€ ë°ì´í„° ì²˜ë¦¬
            Object.values(evaluations).forEach(evaluation => {
                const dept = evaluation.team;
                if (evaluation.evaluatorType === 'chairman' || evaluation.evaluatorType === 'executive') {
                    deptScores[dept].executiveScores.push(evaluation.totalScore);
                } else {
                    deptScores[dept].employeeScores.push(evaluation.totalScore);
                }
            });

            // í‰ê·  ê³„ì‚° ë° ìµœì¢… ì ìˆ˜ ê³„ì‚°
            presentingDepts.forEach(dept => {
                const deptData = deptScores[dept];
                
                if (deptData.executiveScores.length > 0) {
                    deptData.executiveAvg = deptData.executiveScores.reduce((a, b) => a + b, 0) / deptData.executiveScores.length;
                }
                
                if (deptData.employeeScores.length > 0) {
                    deptData.employeeAvg = deptData.employeeScores.reduce((a, b) => a + b, 0) / deptData.employeeScores.length;
                }
                
                deptData.finalScore = (deptData.executiveAvg * 0.6) + (deptData.employeeAvg * 0.4);
            });

            // ìˆœìœ„ ì •ë ¬
            const sortedDepts = presentingDepts.sort((a, b) => deptScores[b].finalScore - deptScores[a].finalScore);

            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const tbody = document.getElementById('resultsTableBody');
            tbody.innerHTML = '';

            sortedDepts.forEach((dept, index) => {
                const deptData = deptScores[dept];
                const rank = index + 1;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <span class="rank-badge rank-${rank <= 3 ? rank : 'other'}">
                            ${rank}ìœ„
                        </span>
                    </td>
                    <td>${dept}</td>
                    <td><strong>${deptData.finalScore.toFixed(1)}ì </strong></td>
                    <td>${deptData.executiveAvg.toFixed(1)}ì  (${deptData.executiveScores.length}ëª…)</td>
                    <td>${deptData.employeeAvg.toFixed(1)}ì  (${deptData.employeeScores.length}ëª…)</td>
                    <td>${deptData.executiveScores.length + deptData.employeeScores.length}ëª…</td>
                `;
                tbody.appendChild(row);
            });

            updateStats();
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const totalEvaluations = Object.keys(evaluations).length;
            const executiveEvaluations = Object.values(evaluations).filter(e => e.evaluatorType === 'chairman' || e.evaluatorType === 'executive').length;
            const employeeEvaluations = Object.values(evaluations).filter(e => e.evaluatorType === 'employee').length;
            
            const expectedExecutive = 7 * 8;
            const expectedEmployee = presentingDepts.length * 25;
            const expectedTotal = expectedExecutive + expectedEmployee;
            const completionRate = expectedTotal > 0 ? ((totalEvaluations / expectedTotal) * 100).toFixed(1) : 0;

            document.getElementById('totalEvaluations').textContent = totalEvaluations;
            document.getElementById('executiveEvaluations').textContent = executiveEvaluations;
            document.getElementById('employeeEvaluations').textContent = employeeEvaluations;
            document.getElementById('completionRate').textContent = completionRate + '%';
        }

        // ëª¨ë‹ˆí„°ë§ ì—…ë°ì´íŠ¸
        function updateMonitor() {
            updateProgressOverview();
            updateExecutiveStatus();
            updateDepartmentStatus();
            updateTeamStatus();
            updateRecentActivity();
        }

        // ì „ì²´ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        function updateProgressOverview() {
            const totalEvaluations = Object.keys(evaluations).length;
            const executiveEvals = Object.values(evaluations).filter(e => e.evaluatorType === 'chairman' || e.evaluatorType === 'executive').length;
            const employeeEvals = Object.values(evaluations).filter(e => e.evaluatorType === 'employee').length;
            
            const expectedExecutive = 7 * 8;
            let expectedEmployee = 0;
            presentingDepts.forEach(dept => {
                expectedEmployee += 25;
            });
            const expectedTotal = expectedExecutive + expectedEmployee;

            const overallProgress = expectedTotal > 0 ? ((totalEvaluations / expectedTotal) * 100).toFixed(1) : 0;
            const executiveProgress = expectedExecutive > 0 ? ((executiveEvals / expectedExecutive) * 100).toFixed(1) : 0;
            const employeeProgress = expectedEmployee > 0 ? ((employeeEvals / expectedEmployee) * 100).toFixed(1) : 0;

            document.getElementById('overallProgress').textContent = overallProgress + '%';
            document.getElementById('executiveProgress').textContent = executiveProgress + '%';
            document.getElementById('employeeProgress').textContent = employeeProgress + '%';
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
        }

        // ì„ì› í‰ê°€ í˜„í™© ì—…ë°ì´íŠ¸
        function updateExecutiveStatus() {
            const executiveStatus = document.getElementById('executiveStatus');
            executiveStatus.innerHTML = '';

            executives.forEach(executive => {
                const evaluationsByExec = Object.values(evaluations).filter(e => 
                    (e.evaluatorType === 'chairman' && executive === 'ì´ì‚¬ì¥') ||
                    (e.evaluatorType === 'executive' && e.executivePosition === executive)
                );

                let expectedCount = 8;
                
                if (executive !== 'ì´ì‚¬ì¥' && divisionMapping[executive]) {
                    const excludedTeams = divisionMapping[executive].filter(dept => presentingDepts.includes(dept));
                    expectedCount = 8 - excludedTeams.length;
                }

                const completedCount = evaluationsByExec.length;

                let statusClass = 'missing';
                let badgeClass = 'badge-missing';
                let statusText = 'ë¯¸ì™„ë£Œ';

                if (completedCount === expectedCount && expectedCount > 0) {
                    statusClass = 'completed';
                    badgeClass = 'badge-completed';
                    statusText = 'ì™„ë£Œ';
                } else if (completedCount > 0) {
                    statusClass = 'partial';
                    badgeClass = 'badge-partial';
                    statusText = `${completedCount}/${expectedCount}`;
                } else if (expectedCount === 0) {
                    statusClass = 'not-applicable';
                    badgeClass = 'badge-na';
                    statusText = 'í•´ë‹¹ì—†ìŒ';
                }

                const statusItem = document.createElement('div');
                statusItem.className = `status-item ${statusClass}`;
                statusItem.innerHTML = `
                    <span><strong>${executive}</strong></span>
                    <span class="status-badge ${badgeClass}">${statusText}</span>
                `;
                executiveStatus.appendChild(statusItem);
            });
        }

        // ë¶€ì„œë³„ ì§ì› í‰ê°€ í˜„í™© ì—…ë°ì´íŠ¸
        function updateDepartmentStatus() {
            const departmentStatus = document.getElementById('departmentStatus');
            departmentStatus.innerHTML = '';

            allDepartments.forEach(dept => {
                const employeeEvals = Object.values(evaluations).filter(e => 
                    e.evaluatorType === 'employee' && e.evaluatorDept === dept
                );

                const availableTeams = presentingDepts.filter(team => team !== dept);
                const expectedCount = availableTeams.length;
                const completedCount = employeeEvals.length;

                let statusClass = 'missing';
                let badgeClass = 'badge-missing';
                let statusText = 'ë¯¸ì°¸ì—¬';

                if (expectedCount === 0) {
                    statusClass = 'not-applicable';
                    badgeClass = 'badge-na';
                    statusText = 'í•´ë‹¹ì—†ìŒ';
                } else if (completedCount >= expectedCount * 0.8) {
                    statusClass = 'completed';
                    badgeClass = 'badge-completed';
                    statusText = `í™œë°œ (${completedCount}ëª…)`;
                } else if (completedCount > 0) {
                    statusClass = 'partial';
                    badgeClass = 'badge-partial';
                    statusText = `ì¼ë¶€ (${completedCount}ëª…)`;
                } else {
                    statusClass = 'missing';
                    badgeClass = 'badge-missing';
                    statusText = 'ë¯¸ì™„ë£Œ';
                }

                const statusItem = document.createElement('div');
                statusItem.className = `status-item ${statusClass}`;
                statusItem.innerHTML = `
                    <span><strong>${dept}</strong></span>
                    <span class="status-badge ${badgeClass}">${statusText}</span>
                `;
                departmentStatus.appendChild(statusItem);
            });
        }

        // ë°œí‘œíŒ€ë³„ í‰ê°€ í˜„í™© ì—…ë°ì´íŠ¸
        function updateTeamStatus() {
            const teamStatusGrid = document.getElementById('teamStatusGrid');
            teamStatusGrid.innerHTML = '';

            presentingDepts.forEach(team => {
                const teamEvals = Object.values(evaluations).filter(e => e.team === team);
                const executiveEvals = teamEvals.filter(e => e.evaluatorType === 'chairman' || e.evaluatorType === 'executive');
                const employeeEvals = teamEvals.filter(e => e.evaluatorType === 'employee');

                const belongingDivision = getDivisionByDept(team);
                const expectedExecutives = belongingDivision ? 6 : 7;
                const expectedEmployees = 25;

                const execProgress = expectedExecutives > 0 ? ((executiveEvals.length / expectedExecutives) * 100).toFixed(0) : 0;
                const empProgress = expectedEmployees > 0 ? ((employeeEvals.length / expectedEmployees) * 100).toFixed(0) : 0;

                const teamCard = document.createElement('div');
                teamCard.className = 'team-status-card';
                teamCard.innerHTML = `
                    <h4 style="color: #4CAF50; margin-bottom: 15px;">${team}</h4>
                    <div style="margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>ğŸ‘” ì„ì› í‰ê°€</span>
                            <span><strong>${executiveEvals.length}/${expectedExecutives}</strong></span>
                        </div>
                        <div style="background: #e0e0e0; border-radius: 10px; height: 8px;">
                            <div style="background: #4CAF50; width: ${execProgress}%; height: 100%; border-radius: 10px; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>ğŸ‘¥ ì§ì› í‰ê°€</span>
                            <span><strong>${employeeEvals.length}</strong>ëª…</span>
                        </div>
                        <div style="background: #e0e0e0; border-radius: 10px; height: 8px;">
                            <div style="background: #2196F3; width: ${Math.min(empProgress, 100)}%; height: 100%; border-radius: 10px; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; font-size: 0.9em; color: #666;">
                        ì´ ${teamEvals.length}ê°œ í‰ê°€ ì™„ë£Œ
                    </div>
                `;
                teamStatusGrid.appendChild(teamCard);
            });
        }

        // ìµœê·¼ í™œë™ ì—…ë°ì´íŠ¸
        function updateRecentActivity() {
            const recentActivity = document.getElementById('recentActivity');
            const sortedEvaluations = Object.values(evaluations)
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 20);

            recentActivity.innerHTML = '';

            if (sortedEvaluations.length === 0) {
                recentActivity.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">ì•„ì§ í‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            sortedEvaluations.forEach((eval, index) => {
                const time = new Date(eval.timestamp).toLocaleTimeString();
                const evaluatorInfo = eval.evaluatorType === 'employee' ? 
                    `${eval.evaluatorDept} ${eval.evaluatorName}` : 
                    `${eval.evaluatorType === 'chairman' ? 'ì´ì‚¬ì¥' : eval.executivePosition} ${eval.evaluatorName}`;

                const activityItem = document.createElement('div');
                activityItem.className = `activity-item ${index < 3 ? 'blinking' : ''}`;
                activityItem.innerHTML = `
                    <div>
                        <strong>${evaluatorInfo}</strong>ì´(ê°€) <span style="color: #4CAF50;">${eval.team}</span> í‰ê°€ ì™„ë£Œ
                        <div style="font-size: 0.9em; color: #666;">ì ìˆ˜: ${eval.totalScore}ì </div>
                    </div>
                    <div class="activity-time">${time}</div>
                `;
                recentActivity.appendChild(activityItem);
            });
        }

        // ë¯¸ì™„ë£Œì ëª…ë‹¨ ì¶œë ¥
        function exportMissingList() {
            let missingList = "2025ë…„ë„ ìƒë°˜ê¸° ì„œì‹œê³µ ì–´ì›Œë“œ í‰ê°€ ë¯¸ì™„ë£Œì ëª…ë‹¨\n";
            missingList += "ìƒì„±ì¼ì‹œ: " + new Date().toLocaleString() + "\n\n";

            missingList += "=== ì„ì› ë¯¸ì™„ë£Œ í˜„í™© ===\n";
            executives.forEach(executive => {
                const evaluationsByExec = Object.values(evaluations).filter(e => 
                    (e.evaluatorType === 'chairman' && executive === 'ì´ì‚¬ì¥') ||
                    (e.evaluatorType === 'executive' && e.executivePosition === executive)
                );

                let expectedCount = 8;
                if (executive !== 'ì´ì‚¬ì¥' && divisionMapping[executive]) {
                    const excludedTeams = divisionMapping[executive].filter(dept => presentingDepts.includes(dept));
                    expectedCount = 8 - excludedTeams.length;
                }

                if (evaluationsByExec.length < expectedCount) {
                    missingList += `${executive}: ${evaluationsByExec.length}/${expectedCount} ì™„ë£Œ\n`;
                }
            });

            missingList += "\n=== ë¶€ì„œë³„ ì§ì› ì°¸ì—¬ í˜„í™© ===\n";
            allDepartments.forEach(dept => {
                const employeeEvals = Object.values(evaluations).filter(e => 
                    e.evaluatorType === 'employee' && e.evaluatorDept === dept
                );
                const availableTeams = presentingDepts.filter(team => team !== dept);
                
                if (availableTeams.length > 0) {
                    missingList += `${dept}: ${employeeEvals.length}ëª… ì°¸ì—¬\n`;
                }
            });

            const blob = new Blob([missingList], { type: 'text/plain;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '2025_ì„œì‹œê³µì–´ì›Œë“œ_í‰ê°€_ë¯¸ì™„ë£Œì_ëª…ë‹¨_' + new Date().toISOString().slice(0,16).replace('T', '_') + '.txt';
            link.click();
        }

        // ê´€ë¦¬ íƒ­ ì—…ë°ì´íŠ¸
        function updateManagement() {
            const statusDiv = document.getElementById('evaluationStatus');
            statusDiv.innerHTML = '';

            const evaluationsByDept = {};
            presentingDepts.forEach(dept => {
                evaluationsByDept[dept] = {
                    executive: 0,
                    employee: 0
                };
            });

            Object.values(evaluations).forEach(evaluation => {
                if (evaluation.evaluatorType === 'chairman' || evaluation.evaluatorType === 'executive') {
                    evaluationsByDept[evaluation.team].executive++;
                } else {
                    evaluationsByDept[evaluation.team].employee++;
                }
            });

            presentingDepts.forEach(dept => {
                const deptData = evaluationsByDept[dept];
                const statusCard = document.createElement('div');
                statusCard.className = 'stat-card';
                statusCard.style.margin = '10px';
                
                const belongingDivision = getDivisionByDept(dept);
                const excludedExecutives = belongingDivision ? 1 : 0;
                const expectedExecutives = 7 - excludedExecutives;
                
                statusCard.innerHTML = `
                    <h4 style="margin-bottom: 10px; color: #4CAF50;">${dept}</h4>
                    <p>ì„ì› í‰ê°€: ${deptData.executive}/${expectedExecutives}ëª…</p>
                    <p>ì§ì› í‰ê°€: ${deptData.employee}ëª…</p>
                    ${belongingDivision ? `<p style="font-size: 0.9em; color: #666;">â€» ${belongingDivision} ì œì™¸</p>` : ''}
                `;
                statusDiv.appendChild(statusCard);
            });
        }

        // ê²°ê³¼ ë‚´ë³´ë‚´ê¸°
        function exportResults() {
            const deptScores = {};
            
            presentingDepts.forEach(dept => {
                deptScores[dept] = {
                    executiveScores: [],
                    employeeScores: [],
                    executiveAvg: 0,
                    employeeAvg: 0,
                    finalScore: 0
                };
            });

            Object.values(evaluations).forEach(evaluation => {
                const dept = evaluation.team;
                if (evaluation.evaluatorType === 'chairman' || evaluation.evaluatorType === 'executive') {
                    deptScores[dept].executiveScores.push(evaluation.totalScore);
                } else {
                    deptScores[dept].employeeScores.push(evaluation.totalScore);
                }
            });

            presentingDepts.forEach(dept => {
                const deptData = deptScores[dept];
                
                if (deptData.executiveScores.length > 0) {
                    deptData.executiveAvg = deptData.executiveScores.reduce((a, b) => a + b, 0) / deptData.executiveScores.length;
                }
                
                if (deptData.employeeScores.length > 0) {
                    deptData.employeeAvg = deptData.employeeScores.reduce((a, b) => a + b, 0) / deptData.employeeScores.length;
                }
                
                deptData.finalScore = (deptData.executiveAvg * 0.6) + (deptData.employeeAvg * 0.4);
            });

            const sortedDepts = presentingDepts.sort((a, b) => deptScores[b].finalScore - deptScores[a].finalScore);

            let csvContent = "ìˆœìœ„,ë¶€ì„œëª…,ìµœì¢…ì ìˆ˜,ì„ì›í‰ê· ,ì§ì›í‰ê· ,ì„ì›í‰ê°€ìˆ˜,ì§ì›í‰ê°€ìˆ˜\n";
            sortedDepts.forEach((dept, index) => {
                const deptData = deptScores[dept];
                csvContent += `${index + 1},${dept},${deptData.finalScore.toFixed(1)},${deptData.executiveAvg.toFixed(1)},${deptData.employeeAvg.toFixed(1)},${deptData.executiveScores.length},${deptData.employeeScores.length}\n`;
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '2025_ì„œì‹œê³µì–´ì›Œë“œ_í‰ê°€ê²°ê³¼.csv';
            link.click();
        }

        // ê²°ê³¼ ì¸ì‡„
        function printResults() {
            window.print();
        }

        // ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”
        function resetAllData() {
            if (confirm('âš ï¸ ëª¨ë“  í‰ê°€ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                evaluations = {};
                updateResults();
                updateManagement();
                updateMonitor();
                alert('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializePageMode();  // í˜ì´ì§€ ëª¨ë“œ ì´ˆê¸°í™” ì¶”ê°€
            updateQRCode();
            updateResults();
            updateManagement();
            updateMonitor();
        });

        // ìë™ ìƒˆë¡œê³ ì¹¨ (5ì´ˆë§ˆë‹¤)
        setInterval(function() {
            if (document.getElementById('results').classList.contains('active')) {
                updateResults();
            } else if (document.getElementById('monitor').classList.contains('active')) {
                updateMonitor();
            }
        }, 5000);
    </script>
</body>
</html>